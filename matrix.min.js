function Vector(){}function Matrix(){}var Sylvester={version:"0.1.3",precision:1e-20};Vector.prototype={e:function(e){return 1>e||e>this.elements.length?null:this.elements[e-1]},dimensions:function(){return this.elements.length},modulus:function(){return Math.sqrt(this.dot(this))},eql:function(e){var t=this.elements.length,n=e.elements||e;if(t!=n.length)return!1;do if(Math.abs(this.elements[t-1]-n[t-1])>Sylvester.precision)return!1;while(--t);return!0},dup:function(){return Vector.create(this.elements)},map:function(e){var t=[];return this.each(function(n,r){t.push(e(n,r))}),Vector.create(t)},each:function(e){var r,t=this.elements.length,n=t;do r=n-t,e(this.elements[r],r+1);while(--t)},toUnitVector:function(){var e=this.modulus();return 0===e?this.dup():this.map(function(t){return t/e})},angleFrom:function(e){var t=e.elements||e,n=this.elements.length;if(n!=t.length)return null;var s=0,u=0,l=0;if(this.each(function(e,n){s+=e*t[n-1],u+=e*e,l+=t[n-1]*t[n-1]}),u=Math.sqrt(u),l=Math.sqrt(l),u*l===0)return null;var a=s/(u*l);return-1>a&&(a=-1),a>1&&(a=1),Math.acos(a)},isParallelTo:function(e){var t=this.angleFrom(e);return null===t?null:t<=Sylvester.precision},isPerpendicularTo:function(e){var t=this.dot(e);return null===t?null:Math.abs(t)<=Sylvester.precision},add:function(e){var t=e.elements||e;return this.elements.length!=t.length?null:this.map(function(e,n){return e+t[n-1]})},subtract:function(e){var t=e.elements||e;return this.elements.length!=t.length?null:this.map(function(e,n){return e-t[n-1]})},multiply:function(e){return this.map(function(t){return t*e})},x:function(e){return this.multiply(e)},dot:function(e){var t=e.elements||e,r=0,i=this.elements.length;if(i!=t.length)return null;do r+=this.elements[i-1]*t[i-1];while(--i);return r},cross:function(e){var t=e.elements||e;if(3!=this.elements.length||3!=t.length)return null;var n=this.elements;return Vector.create([n[1]*t[2]-n[2]*t[1],n[2]*t[0]-n[0]*t[2],n[0]*t[1]-n[1]*t[0]])},max:function(){var r,e=0,t=this.elements.length,n=t;do r=n-t,Math.abs(this.elements[r])>Math.abs(e)&&(e=this.elements[r]);while(--t);return e},indexOf:function(e){var i,t=null,n=this.elements.length,r=n;do i=r-n,null===t&&this.elements[i]==e&&(t=i+1);while(--n);return t},toDiagonalMatrix:function(){return Matrix.Diagonal(this.elements)},round:function(){return this.map(function(e){return Math.round(e)})},snapTo:function(e){return this.map(function(t){return Math.abs(t-e)<=Sylvester.precision?e:t})},distanceFrom:function(e){if(e.anchor)return e.distanceFrom(this);var t=e.elements||e;if(t.length!=this.elements.length)return null;var r,n=0;return this.each(function(e,i){r=e-t[i-1],n+=r*r}),Math.sqrt(n)},to3D:function(){var e=this.dup();switch(e.elements.length){case 3:break;case 2:e.elements.push(0);break;default:return null}return e},inspect:function(){return"["+this.elements.join(", ")+"]"},setElements:function(e){return this.elements=(e.elements||e).slice(),this}},Vector.create=function(e){var t=new Vector;return t.setElements(e)},Vector.i=Vector.create([1,0,0]),Vector.j=Vector.create([0,1,0]),Vector.k=Vector.create([0,0,1]),Matrix.prototype={e:function(e,t){return 1>e||e>this.elements.length||1>t||t>this.elements[0].length?null:this.elements[e-1][t-1]},row:function(e){return e>this.elements.length?null:Vector.create(this.elements[e-1])},col:function(e){if(e>this.elements[0].length)return null;var i,t=[],n=this.elements.length,r=n;do i=r-n,t.push(this.elements[i][e-1]);while(--n);return Vector.create(t)},dimensions:function(){return{rows:this.elements.length,cols:this.elements[0].length}},rows:function(){return this.elements.length},cols:function(){return this.elements[0].length},eql:function(e){var t=e.elements||e;if("undefined"==typeof t[0][0]&&(t=Matrix.create(t).elements),this.elements.length!=t.length||this.elements[0].length!=t[0].length)return!1;var i,s,l,n=this.elements.length,r=n,u=this.elements[0].length;do{i=r-n,s=u;do if(l=u-s,Math.abs(this.elements[i][l]-t[i][l])>Sylvester.precision)return!1;while(--s)}while(--n);return!0},dup:function(){return Matrix.create(this.elements)},map:function(e){var i,s,l,t=[],n=this.elements.length,r=n,u=this.elements[0].length;do{i=r-n,s=u,t[i]=[];do l=u-s,t[i][l]=e(this.elements[i][l],i+1,l+1);while(--s)}while(--n);return Matrix.create(t)},isSameSizeAs:function(e){var t=e.elements||e;return"undefined"==typeof t[0][0]&&(t=Matrix.create(t).elements),this.elements.length==t.length&&this.elements[0].length==t[0].length},add:function(e){var t=e.elements||e;return"undefined"==typeof t[0][0]&&(t=Matrix.create(t).elements),this.isSameSizeAs(t)?this.map(function(e,n,r){return e+t[n-1][r-1]}):null},subtract:function(e){var t=e.elements||e;return"undefined"==typeof t[0][0]&&(t=Matrix.create(t).elements),this.isSameSizeAs(t)?this.map(function(e,n,r){return e-t[n-1][r-1]}):null},canMultiplyFromLeft:function(e){var t=e.elements||e;return"undefined"==typeof t[0][0]&&(t=Matrix.create(t).elements),this.elements[0].length==t.length},multiply:function(e){if(!e.elements)return this.map(function(t){return t*e});var t=e.modulus?!0:!1,n=e.elements||e;if("undefined"==typeof n[0][0]&&(n=Matrix.create(n).elements),!this.canMultiplyFromLeft(n))return null;var s,u,a,f,c,m,r=this.elements.length,i=r,l=n[0].length,o=this.elements[0].length,h=[];do{s=i-r,h[s]=[],u=l;do{a=l-u,f=0,c=o;do m=o-c,f+=this.elements[s][m]*n[m][a];while(--c);h[s][a]=f}while(--u)}while(--r);var n=Matrix.create(h);return t?n.col(1):n},x:function(e){return this.multiply(e)},minor:function(e,t,n,r){var u,l,a,i=[],s=n,o=this.elements.length,h=this.elements[0].length;do{u=n-s,i[u]=[],l=r;do a=r-l,i[u][a]=this.elements[(e+u-1)%o][(t+a-1)%h];while(--l)}while(--s);return Matrix.create(i)},transpose:function(){var i,s,u,e=this.elements.length,t=this.elements[0].length,n=[],r=t;do{i=t-r,n[i]=[],s=e;do u=e-s,n[i][u]=this.elements[u][i];while(--s)}while(--r);return Matrix.create(n)},isSquare:function(){return this.elements.length==this.elements[0].length},max:function(){var r,i,u,e=0,t=this.elements.length,n=t,s=this.elements[0].length;do{r=n-t,i=s;do u=s-i,Math.abs(this.elements[r][u])>Math.abs(e)&&(e=this.elements[r][u]);while(--i)}while(--t);return e},indexOf:function(e){var i,s,l,n=this.elements.length,r=n,u=this.elements[0].length;do{i=r-n,s=u;do if(l=u-s,this.elements[i][l]==e)return{i:i+1,j:l+1};while(--s)}while(--n);return null},diagonal:function(){if(!this.isSquare)return null;var r,e=[],t=this.elements.length,n=t;do r=n-t,e.push(this.elements[r][r]);while(--t);return Vector.create(e)},toRightTriangular:function(){var t,i,s,l,e=this.dup(),n=this.elements.length,r=n,u=this.elements[0].length;do{if(i=r-n,0==e.elements[i][i])for(j=i+1;r>j;j++)if(0!=e.elements[j][i]){t=[],s=u;do l=u-s,t.push(e.elements[i][l]+e.elements[j][l]);while(--s);e.elements[i]=t;break}if(0!=e.elements[i][i])for(j=i+1;r>j;j++){var a=e.elements[j][i]/e.elements[i][i];t=[],s=u;do l=u-s,t.push(i>=l?0:e.elements[j][l]-e.elements[i][l]*a);while(--s);e.elements[j]=t}}while(--n);return e},determinant:function(){if(!this.isSquare())return null;var i,e=this.toRightTriangular(),t=e.elements[0][0],n=e.elements.length-1,r=n;do i=r-n+1,t*=e.elements[i][i];while(--n);return t},det:function(){return this.determinant()},isSingular:function(){return this.isSquare()&&0===this.determinant()},trace:function(){if(!this.isSquare())return null;var r,e=this.elements[0][0],t=this.elements.length-1,n=t;do r=n-t+1,e+=this.elements[r][r];while(--t);return e},tr:function(){return this.trace()},rank:function(){var i,s,l,e=this.toRightTriangular(),t=0,n=this.elements.length,r=n,u=this.elements[0].length;do{i=r-n,s=u;do if(l=u-s,Math.abs(e.elements[i][l])>Sylvester.precision){t++;break}while(--s)}while(--n);return t},rk:function(){return this.rank()},augment:function(e){var t=e.elements||e;"undefined"==typeof t[0][0]&&(t=Matrix.create(t).elements);var u,l,o,n=this.dup(),r=n.elements[0].length,i=n.elements.length,s=i,a=t[0].length;if(i!=t.length)return null;do{u=s-i,l=a;do o=a-l,n.elements[u][r+o]=t[u][o];while(--l)}while(--i);return n},inverse:function(){if(!this.isSquare()||this.isSingular())return null;var n,r,s,l,a,o,f,e=this.elements.length,t=e,i=this.augment(Matrix.I(e)).toRightTriangular(),u=i.elements[0].length,h=[];do{n=e-1,a=[],s=u,h[n]=[],o=i.elements[n][n];do l=u-s,f=i.elements[n][l]/o,a.push(f),l>=t&&h[n].push(f);while(--s);for(i.elements[n]=a,r=0;n>r;r++){a=[],s=u;do l=u-s,a.push(i.elements[r][l]-i.elements[n][l]*i.elements[r][n]);while(--s);i.elements[r]=a}}while(--e);return Matrix.create(h)},inv:function(){return this.inverse()},round:function(){return this.map(function(e){return Math.round(e)})},snapTo:function(e){return this.map(function(t){return Math.abs(t-e)<=Sylvester.precision?e:t})},inspect:function(){var r,e=[],t=this.elements.length,n=t;do r=n-t,e.push(Vector.create(this.elements[r]).inspect());while(--t);return e.join("\n")},setElements:function(e){var t,n=e.elements||e;if("undefined"!=typeof n[0][0]){var s,u,l,r=n.length,i=r;this.elements=[];do{t=i-r,s=n[t].length,u=s,this.elements[t]=[];do l=u-s,this.elements[t][l]=n[t][l];while(--s)}while(--r);return this}var a=n.length,o=a;this.elements=[];do t=o-a,this.elements.push([n[t]]);while(--a);return this}},Matrix.create=function(e){var t=new Matrix;return t.setElements(e)},Matrix.I=function(e){var r,i,s,t=[],n=e;do{r=n-e,t[r]=[],i=n;do s=n-i,t[r][s]=r==s?1:0;while(--i)}while(--e);return Matrix.create(t)},Matrix.Diagonal=function(e){var r,t=e.length,n=t,i=Matrix.I(t);do r=n-t,i.elements[r][r]=e[r];while(--t);return i},Matrix.Zero=function(e,t){var i,s,u,n=[],r=e;do{i=e-r,n[i]=[],s=t;do u=t-s,n[i][u]=0;while(--s)}while(--r);return Matrix.create(n)};var $V=Vector.create,$M=Matrix.create;
