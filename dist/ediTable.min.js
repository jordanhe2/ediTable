(function(){"use strict";function e(e){return e=e[0].map(function(t,n){return e.map(function(e){return e[n]})}),e}function t(e){return Array.apply(null,e)}function n(e){var n=e.rows,r=[];for(var i=0;i<n.length;i++)r[i]=t(n[i].cells);return r}function r(e){if(typeof e=="undefined"||typeof e.func=="undefined"||typeof e.arr=="undefined"||e.arr.length==0)return;typeof e.start=="undefined"&&(e.start=0),typeof e.end=="undefined"&&(e.end=e.arr.length-1),typeof e.dir=="undefined"&&(e.dir=e.end>e.start?1:-1),typeof e.funcContext=="undefined"&&(e.funcContext=null);var t=Math.min(e.start,e.end),n=Math.max(e.start,e.end),r=e.dir>0?t:n;while(r>=t&&r<=n)e.func.apply(e.funcContext,[e.arr[r],r]),r+=e.dir}function i(e){if(typeof e=="undefined"||typeof e.func=="undefined"||typeof e.arr=="undefined"||e.arr.length==0||!u(e.arr))return;typeof e.rowStart=="undefined"&&(e.rowStart=0),typeof e.colStart=="undefined"&&(e.colStart=0),typeof e.rowEnd=="undefined"&&(e.rowEnd=e.arr.length-1),typeof e.colEnd=="undefined"&&(e.colEnd=e.arr[0].length-1),typeof e.rowDir=="undefined"&&(e.rowDir=e.rowEnd>e.rowStart?1:-1),typeof e.colDir=="undefined"&&(e.colDir=e.colEnd>e.colStart?1:-1),typeof e.funcContext=="undefined"&&(e.funcContext=null),r({arr:e.arr,start:e.rowStart,end:e.rowEnd,dir:e.rowDir,func:function(t){r({arr:t,start:e.colStart,end:e.colEnd,dir:e.colDir,func:function(t){e.func.apply(e.funcContext,[t])}})}})}function s(e,t){var n=Object.prototype.toString,r="[object Array]",i=[],s=t&&e||e.slice(),o;if(!e.length)return i;o=s.pop();do n.call(o)===r?s.push.apply(s,o):i.push(o);while(s.length&&(o=s.pop())!==undefined);return i.reverse(),i}function o(e){typeof e.table!="undefined"&&(e.arr=n(e.table));var t=null,r=null,s=e.func,o=function(e,n){r=e,t||(t=e),s(e,n)};return e.func=o,i(e),{first:t,last:r}}function u(e){if(e instanceof Array){var t=e.length>0&&e[0]instanceof Array?e[0].length:0;for(var n=1;n<e.length;n++){var r=e[n];if(!(r instanceof Array))return!1;if(r.length!=t)return!1}return!0}return!1}function a(e){if(document.body.createTextRange){var t=document.body.createTextRange();t.moveToElementText(e),t.select()}else if(window.getSelection){var n=window.getSelection(),t=document.createRange();t.selectNodeContents(e),n.removeAllRanges(),n.addRange(t)}}function f(e){var t=0,n=null,r,i;if(window.getSelection)r=window.getSelection(),r.rangeCount&&(i=r.getRangeAt(0),i.commonAncestorContainer.parentNode==e&&(t=i.endOffset));else if(document.selection&&document.selection.createRange){i=document.selection.createRange();if(i.parentElement()==e){var s=document.createElement("span");e.insertBefore(s,e.firstChild);var o=i.duplicate();o.moveToElementText(s),o.setEndPoint("EndToEnd",i),t=o.text.length}}return t}function l(){document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges()}function c(e){var t=$("tr",e).toArray(),n=t.map(function(e){return e.cells.length}),r=Math.max.apply(null,n);for(var i=0;i<t.length;i++){var s=t[i],o=$("td",s).toArray(),u=$("th",s).toArray(),a=r-(o.length+u.length);if(a>0){var f=o.length==0?"th":"td",l=new Array(a);for(var c=0;c<a;c++)l[c]=document.createElement(f);$(s).append(l)}}}function h(e){var t=e.options;if(t.maxRows>-1)while(e.getRowCount()>t.maxRows)e.removeRow(e.getRowCount()-1);if(t.maxCols>-1)while(e.getColCount()>t.maxCols)e.removeCol(e.getColCount()-1);while(e.getRowCount()<t.minRows)e.insertRow(e.getRowCount());while(e.getColCount()<t.minCols)e.insertCol(e.getColCount())}function p(e){var t=e.options,n=e.VectorManager,r=n.isClear(e.getRow(e.getRowCount()-1));!r&&e.rowsCanGrow()&&e.insertRow(e.getRowCount());var i=n.isClear(e.getCol(e.getColCount()-1));!i&&e.colsCanGrow()&&e.insertCol(e.getColCount())}function d(e){var t=e.options,n=e.VectorManager;if(t.shrinkRows)if(t.rowsAllowMiddleShrink){var r=0;while(e.getRowCount()>t.minRows){var i=e.getRowCount()-(t.growRows?2:1),s=i-r;s>=0&&n.isClear(e.getRow(s))?e.removeRow(s):r++;if(s==0)break}}else while(e.getRowCount()>t.minRows){var s=e.getRowCount()-(t.growRows?2:1);if(!(s>=0&&n.isClear(e.getRow(s))))break;e.removeRow(s)}if(t.shrinkCols)if(t.colsAllowMiddleShrink){var r=0;while(e.getColCount()>t.minCols){var o=e.getColCount()-(t.growCols?2:1),u=o-r;u>=0&&n.isClear(e.getCol(u))?e.removeCol(u):r++;if(u==0)break}}else while(e.getColCount()>t.minCols){var u=e.getColCount()-(t.growCols?2:1);if(!(u>=0&&n.isClear(e.getCol(u))))break;e.removeCol(u)}}function v(e){typeof jQuery=="function"&&e instanceof jQuery&&(e=e[0]);var t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=$(window).height()&&t.right<=$(window).width()}function m(e){v(e)||e.scrollIntoView()}Number.prototype.mod=function(e){return(this%e+e)%e};var g=function(t,n){function r(e){typeof e.minRows=="undefined"&&(e.minRows=1),typeof e.minCols=="undefined"&&(e.minCols=1),typeof e.maxRows=="undefined"&&(e.maxRows=-1),typeof e.maxCols=="undefined"&&(e.maxCols=-1),typeof e.growRows=="undefined"&&(e.growRows=!1),typeof e.growCols=="undefined"&&(e.growCols=!1),typeof e.shrinkRows=="undefined"&&(e.shrinkRows=!1),typeof e.shrinkCols=="undefined"&&(e.shrinkCols=!1),typeof e.rowsAllowMiddleShrink=="undefined"&&(e.rowsAllowMiddleShrink=!1),typeof e.colsAllowMiddleShrink=="undefined"&&(e.colsAllowMiddleShrink=!1),typeof e.copyAsHTML=="undefined"&&(e.copyAsHTML=!0),typeof e.pasteAsHTML=="undefined"&&(e.pasteAsHTML=!1),typeof e.rotateWidePaste=="undefined"&&(e.rotateWidePaste=!1),typeof e.scrollSelectionIntoView=="undefined"&&(e.scrollSelectionIntoView=!0),e.minRows<0&&(e.minRows=0),e.minCols<0&&(e.minCols=0),e.maxRows!=-1&&e.minRows>e.maxRows&&(e.maxRows=e.minRows),e.maxCols!=-1&&e.minCols>e.maxCols&&(e.maxCols=e.minCols)}function i(e){var t,n=u.css("display")=="none";return u.hide(),t=document.elementFromPoint(e.clientX,e.clientY),n||u.show(),t}function v(e){if(!o.hasFocus()||o.Selection.isEditing())return;if(o.options.copyAsHTML){var t=o.getSelectedRows(),n=document.createElement("table");for(var r=0;r<t.length;r++){var i=t[r],s=document.createElement("tr");for(var u=0;u<i.length;u++){var a=i[u];s.appendChild($(a).clone()[0])}n.appendChild(s)}e.clipboardData.setData("text/html",n.outerHTML)}var f="",l=o.getSelectedRowValues();for(var r=0;r<l.length;r++){var c=l[r];for(var u=0;u<c.length;u++){var h=c[u];f+=h,u!=c.length-1&&(f+="	")}r!=l.length-1&&(f+="\n")}e.clipboardData.setData("text/plain",f),e.preventDefault()}function m(e){o.hasFocus()&&!o.Selection.isEditing()&&(v(e),o.clearSelection())}function g(t){if(!o.hasFocus())return;if(!o.Selection.isEditing()){t.preventDefault();var n,r,i=[],s=0,u=t.clipboardData.getData("text/html"),a=t.clipboardData.getData("text/plain"),f=o.getSelectedRows();if(u&&u!=""){if(window.DOMParser){var l=new DOMParser;n=l.parseFromString(u,"text/html")}else n=document.implementation.createHTMLDocument(),n.write(u);var c=n.getElementsByTagName("table");r=c.length>0?c[0]:null}if(r){var h=r.rows;for(var p=0;p<h.length;p++){var d=h[p],v=d.cells;v.length>s&&(s=v.length),i[p]=[];for(var m=0;m<v.length;m++){var g=v[m];i[p][m]=g.innerText}}}else if(a){var h=a.split("\n");for(var p=0;p<h.length;p++){var d=h[p],y=d.split("	");y.length>s&&(s=y.length),i[p]=[];for(var m=0;m<y.length;m++){var b=y[m];i[p][m]=b}}}if(i.length>0&&f.length>0){var w=o.Selection.getCoords(f[0][0]);if(o.options.rotateWidePaste){var E=o.options.maxCols==-1&&s+w[0]>o.getColCount()||o.options.maxCols>-1&&s+w[0]>o.options.maxCols,S=s>i.length,x=o.colsCanGrow();!x&&S&&E&&(i=e(i))}o.setRowValues(i,{rowStart:w[0],colStart:w[1]})}}else if(!o.options.pasteAsHTML){t.preventDefault();var b=t.clipboardData.getData("text/plain");document.execCommand("insertHTML",!1,b)}}var o=this;this.table=t,this.options=n||{},this.events={change:[]},c(this.table),r(this.options);var u=$("<div contenteditable></div>").css({cursor:"default",display:"table-row",opacity:"0",position:"absolute","z-index":"1",top:"0",bottom:"0",width:"100%"}).text("ediTable");$(this.table).css({position:"relative"}).append(u),this.CellManager={setEditable:function(e,t){typeof t=="undefined"&&(t=!0),e.contentEditable=t},isEditable:function(e){return e.isContentEditable||e.contentEditable=="true"},setHeader:function(e,t){typeof t=="undefined"&&(t=!0);if(t==this.isHeader(e))return;var n=t?"th":"td",r=e,i=$(r).contents().detach(),s=document.createElement(n);$.each(r.attributes,function(e){$(s).attr(r.attributes[e].name,r.attributes[e].value)}),$(s).append(i),$(r).replaceWith(s)},isHeader:function(e){return e.tagName.toLowerCase()=="th"},select:function(e){$(e).addClass("ediTable-cell-selected")},deselect:function(e){$(e).removeClass("ediTable-cell-selected").removeClass("ediTable-cell-selected-left").removeClass("ediTable-cell-selected-right").removeClass("ediTable-cell-selected-top").removeClass("ediTable-cell-selected-bottom")},isSelected:function(e){return $(e).hasClass("ediTable-cell-selected")},getValue:function(e){return e.innerText},setValue:function(e,t){if(!this.isEditable(e))return;o.options.pasteAsHTML?$(e).html(t):$(e).text(t)},clear:function(e){this.setValue(e,"")},isClear:function(e){return e.innerHTML==""}},this.VectorManager={getSelection:function(e){return e.filter(function(e){return o.CellManager.isSelected(e)})},getValues:function(e){return e.map(function(e){return o.CellManager.getValue(e)})},isHeader:function(e){for(var t=0;t<e.length;t++)if(!o.CellManager.isHeader(e[t]))return!1;return!0},isEditable:function(e){for(var t=0;t<e.length;t++)if(!o.CellManager.isEditable(e[t]))return!1;return!0},isClear:function(e){for(var t=0;t<e.length;t++)if(!o.CellManager.isClear(e[t]))return!1;return!0}},this.Selection=function(){var e,t=$(o.table),n=[],r,c=function(){var e=(new Date).getTime(),t=e-r;return r=(new Date).getTime(),t<600&&t>0},h=function(t){var r=i(t),s=e.getCoords(r);o.lastClicked=r;var u=o.hasFocus();if(!s||!u)o.deselect(),e.exitEditMode();if(!u||!$.contains(o.table,r))return;if(t.type=="touchstart"&&c()){m(t);return}var a=t.which==3;if(s){var f=!a||a&&!o.hasSelection();if(!o.hasSelection()||!t.shiftKey&&o.hasSelection())n=s;e.isEditing()?r!=e.editingCell&&(e.exitEditMode(),f&&o.select({rowStart:n[0],rowEnd:s[0],colStart:n[1],colEnd:s[1]}),t.preventDefault()):f&&o.select({rowStart:n[0],rowEnd:s[0],colStart:n[1],colEnd:s[1]}),f&&$(document).on("mousemove",y).on("touchmove",y)}},v=function(t){!e.isEditing()&&$.contains(o.table,t.target)&&a(u[0])},m=function(t){if(!o.hasFocus())return;var n=i(t),r=e.getCoords(n);r&&e.setEditMode(n)},g=function(e){$(document).unbind("mousemove",y).unbind("touchmove",y)},y=function(t){var r=e.getCoords(i(t));if(t.changedTouches){var s=t.changedTouches,u,a;if(s.length>0){var f=s.item(0);u=f.clientX,a=f.clientY,r=e.getCoords(document.elementFromPoint(u,a))}}!e.isEditing()&&r&&(o.select({rowStart:n[0],rowEnd:r[0],colStart:n[1],colEnd:r[1]}),t.preventDefault())},b=function(t){u.blur();var n=o.hasFocus();if(!n)return;var r=o.hasSelection(),i=e.originCell==e.terminalCell,a=t.keyCode,l=t.ctrlKey,c=t.shiftKey,h=a==9,p=a==13,d=a==27,v=a==46,m=a==8,g=a==37,y=a==38,b=a==39,w=a==40,E=a==36,S=a==35,x=e.editingCell,T=e.isEditing();if(h||p||d||y||w||g&&x&&f(x)==0||b&&x&&f(x)==x.innerText.length)t.preventDefault(),e.exitEditMode();if(!e.isEditing())if(l&&a==65)t.preventDefault(),c?o.deselect():o.select();else if(r){if(t.keyCode==93){e.originCell.focus();return}var N=!i&&(h||p),C=!c&&!N,k=!N,L=!c&&!N,A=e.getCoords(e.originCell),O=e.getCoords(e.terminalCell);if(d&&!T)o.deselect();else if(v||m)t.preventDefault(),o.hasSelection()&&o.clearSelection();else if(p||h){var M;h?M=s(i?o.getRows():o.getSelectedRows()):p&&(M=s(i?o.getCols():o.getSelectedCols()));var _=M.indexOf(i?e.originCell:x);if(i){var D=e.getCoords(M[(_+(c?-1:1)).mod(M.length)]);o.select({rowStart:D[0],rowEnd:D[0],colStart:D[1],colEnd:D[1]})}else N&&e.setEditMode(M[(_+(c?-1:1)).mod(M.length)])}else if(g||y||b||w||E||S){var P={x:0,y:0},H=k&&!L?O:A;switch(a){case 35:P.x=o.getColCount()-H[1]-1,l&&(P.y=o.getRowCount()-H[0]-1);break;case 36:P.x=-H[1],l&&(P.y=-H[0]);break;case 37:P.x=l?P.x=-H[1]:-1;break;case 38:P.y=l?P.y=-H[0]:-1;break;case 39:P.x=l?o.getColCount()-H[1]-1:1;break;case 40:P.y=l?o.getRowCount()-H[0]-1:1}if(A&&O){var B=function(e){return!(e[0]<0||e[0]>=o.getRowCount()||e[1]<0||e[1]>=o.getColCount())};if(C){var D=[A[0]+P.y,A[1]+P.x];B(D)&&(A=D)}if(L)O=A;else if(k){var D=[O[0]+P.y,O[1]+P.x];B(D)&&(O=D)}o.select({rowStart:A[0],rowEnd:O[0],colStart:A[1],colEnd:O[1]})}}}else if(h||p||E||S||g||y||b||w){var j=[0,0];S&&(j[1]=o.getColCount()-1,l&&(j[0]=o.getRowCount()-1)),o.select({rowStart:j[0],rowEnd:j[0],colStart:j[1],colEnd:j[1]})}},w=function(t){var n=o.hasFocus(),r=e.isEditing(),i=o.hasSelection();n&&i&&!r&&e.setEditMode(e.originCell)},E=function(e){var t=o.Selection.getCoords(e.target);d(o),p(o),o.fireEvent("change",{rowStart:t[0],rowEnd:t[0],colStart:t[1],colEnd:t[1]})};return $(document).on("mousedown",h).on("touchstart",h).on("contextmenu",v).on("dblclick",m).on("mouseup",g).on("touchend",g).on("keydown",b).on("keypress",w),e={originCell:null,terminalCell:null,editingCell:null,isEditing:function(){return this.editingCell!=null},setEditMode:function(e){var t=$(e);this.exitEditMode();if(!o.CellManager.isEditable(e))return;u.hide(),e.focus(),a(e),t.addClass("ediTable-cell-editing"),t.on("input",E),o.Selection.editingCell=e},exitEditMode:function(){this.isEditing()&&(this.editingCell.blur(),document.body.focus(),l(),$(this.editingCell).removeClass("ediTable-cell-editing").unbind("input",E),this.editingCell=null,u.show())},getCoords:function(e){if(!$.contains(o.table,e))return null;var t=$(e),n=t.closest("tr > td, tr > th")[0],r=t.closest("tr")[0],i=null;return n&&r&&$.contains(o.table,r)&&(i=[r.rowIndex,n.cellIndex]),i}},e}(),h(this),p(this),d(this),$(this.table).addClass("ediTable").focusin(function(e){if(!o.hasSelection()){var t=o.Selection.getCoords(e.target);if(!t)return;e.target.blur(),o.lastClicked=e.target,l(),o.select({rowStart:t[0],rowEnd:t[0],colStart:t[1],colEnd:t[1]})}}),this.lastClicked=null,this.table.addEventListener("dragstart",function(e){e.preventDefault()}),this.table.addEventListener("drop",function(e){e.preventDefault()}),document.addEventListener("copy",v),document.addEventListener("cut",m),document.addEventListener("paste",g)};g.prototype={addEventListener:function(e,t){this.events[e].push(t)},removeEventListener:function(e,t){var n=this.events[e].indexOf(t);n!=-1&&this.events[e].splice(n,1)},fireEvent:function(e,t){var n=this.events[e];if(n)for(var r=0;r<n.length;r++)n[r](t)},hasFocus:function(){var e=document.activeElement,t=this.lastClicked;return $(e).closest(this.table).length==1||$(t).closest(this.table).length==1||this.hasSelection()},getRowCount:function(){return this.table.rows.length},getColCount:function(){var e=0,t=this.table.rows;for(var n=0;n<t.length;n++)e=Math.max(e,t[n].cells.length);return e},setEditable:function(e,t){typeof e=="undefined"&&(e=!0),typeof t=="undefined"&&(t={}),typeof t.rowStart=="undefined"&&(t.rowStart=0),typeof t.rowEnd=="undefined"&&(t.rowEnd=this.getRowCount()-1),typeof t.colStart=="undefined"&&(t.colStart=0),typeof t.colEnd=="undefined"&&(t.colEnd=this.getColCount()-1);var n=this;t.table=this.table,t.func=function(t){n.CellManager.setEditable(t,e)},o(t)},isEditable:function(e){typeof e=="undefined"&&(e={}),typeof e.rowStart=="undefined"&&(e.rowStart=0),typeof e.rowEnd=="undefined"&&(e.rowEnd=this.getRowCount()-1),typeof e.colStart=="undefined"&&(e.colStart=0),typeof e.colEnd=="undefined"&&(e.colEnd=this.getColCount()-1);var t=!0,n=this;return e.table=this.table,e.func=function(e){n.CellManager.isEditable(e)||(t=!1)},o(e),t},setHeader:function(e,t){typeof e=="undefined"&&(e=!0),typeof t=="undefined"&&(t={}),typeof t.rowStart=="undefined"&&(t.rowStart=0),typeof t.rowEnd=="undefined"&&(t.rowEnd=this.getRowCount()-1),typeof t.colStart=="undefined"&&(t.colStart=0),typeof t.colEnd=="undefined"&&(t.colEnd=this.getColCount()-1);var n=this;t.table=this.table,t.func=function(t){n.CellManager.setHeader(t,e)},o(t)},isHeader:function(e){typeof e=="undefined"&&(e={}),typeof e.rowStart=="undefined"&&(e.rowStart=0),typeof e.rowEnd=="undefined"&&(e.rowEnd=this.getRowCount()-1),typeof e.colStart=="undefined"&&(e.colStart=0),typeof e.colEnd=="undefined"&&(e.colEnd=this.getColCount()-1);var t=!0,n=this;return e.table=this.table,e.func=function(e){n.CellManager.isHeader(e)||(t=!1)},o(e),t},select:function(e){typeof e=="undefined"&&(e={}),typeof e.rowStart=="undefined"&&(e.rowStart=0),typeof e.rowEnd=="undefined"&&(e.rowEnd=this.getRowCount()-1),typeof e.colStart=="undefined"&&(e.colStart=0),typeof e.colEnd=="undefined"&&(e.colEnd=this.getColCount()-1);var t=this;this.deselect(),e.table=this.table,e.func=function(e){t.CellManager.select(e)};var n=o(e);this.Selection.originCell=n.first,this.Selection.terminalCell=n.last;var t=this;(function(){var n=t.table,r=t.table.rows,i=t.getRowCount(),s=t.getColCount(),o=t.CellManager;for(var u=0;u<i;u++){var a=t.table.rows[u];for(var f=0;f<s;f++){var l=a.cells[f],c=$(l);if(!o.isSelected(l))continue;c.toggleClass("ediTable-cell-selected-top",u==0||!o.isSelected(r[u-1].cells[f])),c.toggleClass("ediTable-cell-selected-bottom",u==i-1||!o.isSelected(r[u+1].cells[f])),c.toggleClass("ediTable-cell-selected-left",f==0||!o.isSelected(a.cells[f-1])),c.toggleClass("ediTable-cell-selected-right",f==s-1||!o.isSelected(a.cells[f+1]))}}})();if(this.options.scrollSelectionIntoView){var r=this.Selection.originCell,i=this.Selection.terminalCell;r!=i?m(i):m(r)}},deselect:function(e){typeof e=="undefined"&&(e={}),typeof e.rowStart=="undefined"&&(e.rowStart=0),typeof e.rowEnd=="undefined"&&(e.rowEnd=this.getRowCount()-1),typeof e.colStart=="undefined"&&(e.colStart=0),typeof e.colEnd=="undefined"&&(e.colEnd=this.getColCount()-1);var t=this;e.table=this.table,e.func=function(e){t.CellManager.deselect(e)},o(e)},setRowValues:function(e,t){if(!u(e))throw new TypeError("values parameter must be 2D Array");typeof t=="undefined"&&(t={}),typeof t.rowStart=="undefined"&&(t.rowStart=0),typeof t.colStart=="undefined"&&(t.colStart=0),typeof t.silent=="undefined"&&(t.silent=!1);var n=t.rowStart+e.length,r=this.options.maxRows,i=this.getRowCount(),s=n-i;while((r==-1||i<r)&&s>0&&this.options.growRows)i=this.getRowCount(),s=n-i,this.insertRow(i);var o=t.colStart+e[0].length,a=this.options.maxCols,f=this.getColCount(),l=o-f;while((a==-1||f<a)&&l>0&&this.options.growCols)f=this.getColCount(),l=o-f,this.insertCol(f);var c=this.table.rows,n=0,o=0;for(var h=0;h<e.length&&h<c.length-t.rowStart;h++){var v=h+t.rowStart,m=c[v];for(var g=0;g<e[h].length&&g<m.cells.length-t.colStart;g++){var y=g+t.colStart,b=m.cells[y];this.CellManager.setValue(b,e[h][g]),o=Math.max(o,y)}n=Math.max(n,v)}d(this),p(this),t.silent||this.fireEvent("change",{rowStart:t.rowStart,rowEnd:n,colStart:t.colStart,colEnd:o})},setColValues:function(t,n){if(!u(t))throw new TypeError("values parameter must be 2D Array");typeof n=="undefined"&&(n={}),typeof n.rowStart=="undefined"&&(n.rowStart=0),typeof n.colStart=="undefined"&&(n.colStart=0),typeof n.silent=="undefined"&&(n.silent=!1),t=e(t),t.length==0&&(t[0]=[]),this.setRowValues(t,n)},clear:function(e){typeof e=="undefined"&&(e={}),typeof e.rowStart=="undefined"&&(e.rowStart=0),typeof e.rowEnd=="undefined"&&(e.rowEnd=this.getRowCount()-1),typeof e.colStart=="undefined"&&(e.colStart=0),typeof e.colEnd=="undefined"&&(e.colEnd=this.getColCount()-1),typeof e.silent=="undefined"&&(e.silent=!1);var t=this;e.table=this.table,e.func=function(e){t.CellManager.clear(e)},o(e),d(this),e.silent||this.fireEvent("change",{rowStart:e.rowStart,rowEnd:e.rowEnd,colStart:e.colStart,colEnd:e.colEnd})},clearSelection:function(){var e=this.Selection,t=e.getCoords(e.originCell),n=e.getCoords(e.terminalCell);t&&n&&this.clear({rowStart:t[0],colStart:t[1],rowEnd:n[0],colEnd:n[1]})},isClear:function(e){typeof e=="undefined"&&(e={}),typeof e.rowStart=="undefined"&&(e.rowStart=0),typeof e.rowEnd=="undefined"&&(e.rowEnd=this.getRowCount()-1),typeof e.colStart=="undefined"&&(e.colStart=0),typeof e.colEnd=="undefined"&&(e.colEnd=this.getColCount()-1);var t=!0;return e.table=this.table,e.func=function(e){ctx.CellManager.isClear(e)||(t=!1)},o(e),t},hasSelection:function(){return this.getSelectedRows().length>0},getSelectionBounds:function(){var e=this.Selection,t=e.getCoords(e.originCell),n=e.getCoords(e.terminalCell);return{origin:t,terminal:n}},getRow:function(e,t){typeof t=="undefined"&&(t={}),typeof t.colStart=="undefined"&&(t.colStart=0),typeof t.colEnd=="undefined"&&(t.colEnd=this.getColCount()-1);var n=[],i=this.table.rows[e];return r({arr:i.cells,start:t.colStart,end:t.colEnd,func:function(e){n.push(e)}}),n},getRows:function(e){typeof e=="undefined"&&(e={}),typeof e.rowStart=="undefined"&&(e.rowStart=0),typeof e.rowEnd=="undefined"&&(e.rowEnd=this.getRowCount()-1),typeof e.colStart=="undefined"&&(e.colStart=0),typeof e.colEnd=="undefined"&&(e.colEnd=this.getColCount()-1);var t=this.table.rows,n=[],i=this;return r({arr:t,start:e.rowStart,end:e.rowEnd,func:function(t,r){n.push(i.getRow(r,e))}}),n},getSelectedRows:function(){var e=this;return this.getRows().map(function(t){return e.VectorManager.getSelection(t)}).filter(function(e){return e.length>0})},getRowValues:function(e){var t=this;return this.getRows(e).map(function(e){return t.VectorManager.getValues(e)})},getSelectedRowValues:function(){var e=this;return this.getSelectedRows().map(function(t){return e.VectorManager.getValues(t)})},getCol:function(e,t){typeof t=="undefined"&&(t={}),typeof t.rowStart=="undefined"&&(t.rowStart=0),typeof t.rowEnd=="undefined"&&(t.rowEnd=this.getRowCount()-1);var n=[];return t.table=this.table,t.colStart=e,t.colEnd=e,t.func=function(e){n.push(e)},o(t),n},getCols:function(t){return e(this.getRows(t))},getSelectedCols:function(){return e(this.getSelectedRows())},getColValues:function(t){return e(this.getRowValues(t))},getSelectedColValues:function(){return e(this.getSelectedRowValues())},canInsertRow:function(){return this.options.maxRows==-1||this.table.rows.length<this.options.maxRows},canInsertCol:function(){return this.options.maxCols==-1||this.table.rows[0].cells.length<this.options.maxCols},rowsCanGrow:function(){return this.options.growRows&&this.canInsertRow()},colsCanGrow:function(){var e=this.options;return e.growCols&&this.canInsertCol()},insertRow:function(e){if(!this.canInsertRow())return;var t=this.VectorManager,n=this.getCols(),r=this.table.insertRow(e),i=e>0?this.getRow(e-1):null,s=e<this.getRowCount()-1?this.getRow(e+1):null,o=(i?t.isEditable(i):!0)&&(s?t.isEditable(s):!0),u=(i?t.isHeader(i):!0)&&(s?t.isHeader(s):!0);for(var a=0;a<this.getColCount();a++){var f=r.insertCell(a),l=n[a],c=t.isEditable(l),h=t.isHeader(l);this.CellManager.setEditable(f,o||c),this.CellManager.setHeader(f,u||h)}},insertCol:function(e){if(!this.canInsertCol())return;var t=this.VectorManager,n=this.getRows(),r=e>0?this.getCol(e-1):null,i=e<this.getColCount()-1?this.getCol(e+1):null,s=(r?t.isEditable(r):!0)&&(i?t.isEditable(i):!0),o=(r?t.isHeader(r):!0)&&(i?t.isHeader(i):!0);for(var u=0;u<this.getRowCount();u++){var a=this.table.rows[u].insertCell(e),f=n[u],l=t.isEditable(f),c=t.isHeader(f);this.CellManager.setEditable(a,s||l),this.CellManager.setHeader(a,o||c)}},removeRow:function(e){var t=this.getSelectionBounds();this.table.deleteRow(e);if(t){var n=t.origin,r=t.terminal;if(n&&r){var i=n[1],s=n[0],o=r[1],u=r[0],a=Math.min(s,u),f=Math.max(s,u);if(e<=f&&e>=a){var l=this.getRowCount(),c=f>=l,h={colStart:i,colEnd:o};c?(h.rowStart=s-1>=0?s-1:0,h.rowEnd=u-1>=0?u-1:0):(h.rowStart=s,h.rowEnd=u),this.select(h)}}}},removeCol:function(e){var t=this.getSelectionBounds(),n=this.table.rows;for(var r=0;r<n.length;r++){var i=n[r];i.deleteCell(e)}if(t){var s=t.origin,o=t.terminal;if(s&&o){var u=s[1],a=s[0],f=o[1],l=o[0],c=Math.min(u,f),h=Math.max(u,f);if(e<=h&&e>=c){var p=this.getColCount(),d=h>=p,v={rowStart:a,rowEnd:l};d?(v.colStart=u-1>=0?u-1:0,v.colEnd=f-1>=0?f-1:0):(v.colStart=u,v.colEnd=f),this.select(v)}}}}},window.EdiTable=g})()
