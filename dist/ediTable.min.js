!function(){"use strict";function e(e){return e=e[0].map(function(t,n){return e.map(function(e){return e[n]})})}function t(e){return Array.apply(null,e)}function n(e){for(var n=e.rows,o=[],i=0;i<n.length;i++)o[i]=t(n[i].cells);return o}function o(e){if("undefined"!=typeof e&&"undefined"!=typeof e.func&&"undefined"!=typeof e.arr&&0!=e.arr.length){"undefined"==typeof e.start&&(e.start=0),"undefined"==typeof e.end&&(e.end=e.arr.length-1),"undefined"==typeof e.dir&&(e.dir=e.end>e.start?1:-1),"undefined"==typeof e.funcContext&&(e.funcContext=null);for(var t=Math.min(e.start,e.end),n=Math.max(e.start,e.end),o=e.dir>0?t:n;o>=t&&n>=o;)e.func.apply(e.funcContext,[e.arr[o],o]),o+=e.dir}}function i(e){"undefined"!=typeof e&&"undefined"!=typeof e.func&&"undefined"!=typeof e.arr&&0!=e.arr.length&&a(e.arr)&&("undefined"==typeof e.rowStart&&(e.rowStart=0),"undefined"==typeof e.colStart&&(e.colStart=0),"undefined"==typeof e.rowEnd&&(e.rowEnd=e.arr.length-1),"undefined"==typeof e.colEnd&&(e.colEnd=e.arr[0].length-1),"undefined"==typeof e.rowDir&&(e.rowDir=e.rowEnd>e.rowStart?1:-1),"undefined"==typeof e.colDir&&(e.colDir=e.colEnd>e.colStart?1:-1),"undefined"==typeof e.funcContext&&(e.funcContext=null),o({arr:e.arr,start:e.rowStart,end:e.rowEnd,dir:e.rowDir,func:function(t){o({arr:t,start:e.colStart,end:e.colEnd,dir:e.colDir,func:function(t){e.func.apply(e.funcContext,[t])}})}}))}function r(e,t){var l,n=Object.prototype.toString,o="[object Array]",i=[],r=t&&e||e.slice();if(!e.length)return i;l=r.pop();do n.call(l)===o?r.push.apply(r,l):i.push(l);while(r.length&&void 0!==(l=r.pop()));return i.reverse(),i}function l(e){"undefined"!=typeof e.table&&(e.arr=n(e.table));var t=null,o=null,r=e.func,l=function(e,n){o=e,t||(t=e),r(e,n)};return e.func=l,i(e),{first:t,last:o}}function a(e){if(!(e instanceof Array))return!1;for(var t=e.length>0&&e[0]instanceof Array?e[0].length:0,n=1;n<e.length;n++){var o=e[n];if(!(o instanceof Array))return!1;if(o.length!=t)return!1}return!0}function s(e){if(document.body.createTextRange){var t=document.body.createTextRange();t.moveToElementText(e),t.select()}else if(window.getSelection){var n=window.getSelection(),t=document.createRange();t.selectNodeContents(e),n.removeAllRanges(),n.addRange(t)}}function f(e){var o,i,t=0;if(window.getSelection)o=window.getSelection(),o.rangeCount&&(i=o.getRangeAt(0),i.commonAncestorContainer.parentNode==e&&(t=i.endOffset));else if(document.selection&&document.selection.createRange&&(i=document.selection.createRange(),i.parentElement()==e)){var r=document.createElement("span");e.insertBefore(r,e.firstChild);var l=i.duplicate();l.moveToElementText(r),l.setEndPoint("EndToEnd",i),t=l.text.length}return t}function d(){document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges()}function u(e){for(var t=$("tr",e).toArray(),n=t.map(function(e){return e.cells.length}),o=Math.max.apply(null,n),i=0;i<t.length;i++){var r=t[i],l=$("td",r).toArray(),a=$("th",r).toArray(),s=o-(l.length+a.length);if(s>0){for(var f=0==l.length?"th":"td",d=new Array(s),u=0;s>u;u++)d[u]=document.createElement(f);$(r).append(d)}}}function c(e){var t=e.options;if(t.maxRows>-1)for(;e.getRowCount()>t.maxRows;)e.removeRow(e.getRowCount()-1);if(t.maxCols>-1)for(;e.getColCount()>t.maxCols;)e.removeCol(e.getColCount()-1);for(;e.getRowCount()<t.minRows;)e.insertRow(e.getRowCount());for(;e.getColCount()<t.minCols;)e.insertCol(e.getColCount())}function g(e){var n=(e.options,e.VectorManager),o=n.isClear(e.getRow(e.getRowCount()-1));!o&&e.rowsCanGrow()&&e.insertRow(e.getRowCount());var i=n.isClear(e.getCol(e.getColCount()-1));!i&&e.colsCanGrow()&&e.insertCol(e.getColCount())}function h(e){var t=e.options,n=e.VectorManager;if(t.shrinkRows)if(t.rowsAllowMiddleShrink)for(var o=0;e.getRowCount()>t.minRows;){var i=e.getRowCount()-(t.growRows?2:1),r=i-o;if(r>=0&&n.isClear(e.getRow(r))?e.removeRow(r):o++,0==r)break}else for(;e.getRowCount()>t.minRows;){var r=e.getRowCount()-(t.growRows?2:1);if(!(r>=0&&n.isClear(e.getRow(r))))break;e.removeRow(r)}if(t.shrinkCols)if(t.colsAllowMiddleShrink)for(var o=0;e.getColCount()>t.minCols;){var l=e.getColCount()-(t.growCols?2:1),a=l-o;if(a>=0&&n.isClear(e.getCol(a))?e.removeCol(a):o++,0==a)break}else for(;e.getColCount()>t.minCols;){var a=e.getColCount()-(t.growCols?2:1);if(!(a>=0&&n.isClear(e.getCol(a))))break;e.removeCol(a)}}function w(e){"function"==typeof jQuery&&e instanceof jQuery&&(e=e[0]);var t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=$(window).height()&&t.right<=$(window).width()}function C(e){w(e)||e.scrollIntoView()}Number.prototype.mod=function(e){return(this%e+e)%e};var p=function(e,t){function n(e){"undefined"==typeof e.minRows&&(e.minRows=1),"undefined"==typeof e.minCols&&(e.minCols=1),"undefined"==typeof e.maxRows&&(e.maxRows=-1),"undefined"==typeof e.maxCols&&(e.maxCols=-1),"undefined"==typeof e.growRows&&(e.growRows=!1),"undefined"==typeof e.growCols&&(e.growCols=!1),"undefined"==typeof e.shrinkRows&&(e.shrinkRows=!1),"undefined"==typeof e.shrinkCols&&(e.shrinkCols=!1),"undefined"==typeof e.rowsAllowMiddleShrink&&(e.rowsAllowMiddleShrink=!1),"undefined"==typeof e.colsAllowMiddleShrink&&(e.colsAllowMiddleShrink=!1),"undefined"==typeof e.copyAsHTML&&(e.copyAsHTML=!1),"undefined"==typeof e.pasteAsHTML&&(e.pasteAsHTML=!1),"undefined"==typeof e.scrollSelectionIntoView&&(e.scrollSelectionIntoView=!0),e.minRows<0&&(e.minRows=0),e.minCols<0&&(e.minCols=0),-1!=e.maxRows&&e.minRows>e.maxRows&&(e.maxRows=e.minRows),-1!=e.maxCols&&e.minCols>e.maxCols&&(e.maxCols=e.minCols)}function i(e){if(o.hasFocus()&&!o.Selection.isEditing()){if(o.options.copyAsHTML){for(var t=o.getSelectedRows(),n=document.createElement("table"),i=0;i<t.length;i++){for(var r=t[i],l=document.createElement("tr"),a=0;a<r.length;a++){var s=r[a];l.appendChild($(s).clone()[0])}n.appendChild(l)}e.clipboardData.setData("text/html",n.outerHTML)}for(var f="",d=o.getSelectedRowValues(),i=0;i<d.length;i++){for(var u=d[i],a=0;a<u.length;a++){var c=u[a];f+=c,a!=u.length-1&&(f+="	")}i!=d.length-1&&(f+="\n")}e.clipboardData.setData("text/plain",f),e.preventDefault()}}function l(e){o.hasFocus()&&(i(e),o.clearSelection())}function a(e){if(o.hasFocus())if(o.Selection.isEditing()){if(!o.options.pasteAsHTML){e.preventDefault();var p=e.clipboardData.getData("text/plain");document.execCommand("insertHTML",!1,p)}}else{e.preventDefault();var t,n,i=[],r=e.clipboardData.getData("text/html"),l=e.clipboardData.getData("text/plain"),a=o.getSelectedRows();if(r&&""!=r){if(window.DOMParser){var s=new DOMParser;t=s.parseFromString(r,"text/html")}else t=document.implementation.createHTMLDocument(),t.write(r);var f=t.getElementsByTagName("table");n=f.length>0?f[0]:null}if(n)for(var d=n.rows,u=0;u<d.length;u++){var c=d[u],g=c.cells;i[u]=[];for(var h=0;h<g.length;h++){var w=g[h];i[u][h]=w.innerText}}else if(l)for(var d=l.split("\n"),u=0;u<d.length;u++){var c=d[u],C=c.split("	");i[u]=[];for(var h=0;h<C.length;h++){var p=C[h];i[u][h]=p}}if(i.length>0&&a.length>0){var v=o.Selection.getCoords(a[0][0]);o.setRowValues(i,{rowStart:v[0],colStart:v[1]})}}}var o=this;this.table=e,this.options=t||{},this.events={change:[]},u(this.table),n(this.options),this.CellManager={setEditable:function(e,t){"undefined"==typeof t&&(t=!0),e.contentEditable=t},isEditable:function(e){return e.isContentEditable},setHeader:function(e,t){if("undefined"==typeof t&&(t=!0),t!=this.isHeader(e)){var n=t?"th":"td",o=e,i=$(o).contents().detach(),r=document.createElement(n);$.each(o.attributes,function(e){$(r).attr(o.attributes[e].name,o.attributes[e].value)}),$(r).append(i),$(o).replaceWith(r)}},isHeader:function(e){return"th"==e.tagName.toLowerCase()},select:function(e){$(e).addClass("ediTable-cell-selected")},deselect:function(e){$(e).removeClass("ediTable-cell-selected").removeClass("ediTable-cell-selected-left").removeClass("ediTable-cell-selected-right").removeClass("ediTable-cell-selected-top").removeClass("ediTable-cell-selected-bottom")},isSelected:function(e){return $(e).hasClass("ediTable-cell-selected")},getValue:function(e){return e.innerText},setValue:function(e,t){this.isEditable(e)&&(o.options.pasteAsHTML?$(e).html(t):$(e).text(t))},clear:function(e){this.setValue(e,"")},isClear:function(e){return""==e.innerHTML}},this.VectorManager={getSelection:function(e){return e.filter(function(e){return o.CellManager.isSelected(e)})},getValues:function(e){return e.map(function(e){return o.CellManager.getValue(e)})},isHeader:function(e){for(var t=0;t<e.length;t++)if(!o.CellManager.isHeader(e[t]))return!1;return!0},isEditable:function(e){for(var t=0;t<e.length;t++)if(!o.CellManager.isEditable(e[t]))return!1;return!0},isClear:function(e){for(var t=0;t<e.length;t++)if(!o.CellManager.isClear(e[t]))return!1;return!0}},this.Selection=function(){var e,i,n=($(o.table),[]),l=function(){var e=(new Date).getTime(),t=e-i;return i=(new Date).getTime(),600>t&&t>0},a=function(t){o.lastClicked=t.target;var i=e.getCoords(t.target),r=o.hasFocus();if(i&&r||(o.deselect(),e.exitEditMode()),r){if("touchstart"==t.type&&l())return void u(t);var a=!1;3==t.which&&(a=!0),a&&v.select(),i&&((!o.hasSelection()||!t.shiftKey&&o.hasSelection())&&(n=i),t.target!=e.editingCell&&(e.exitEditMode(),(!a||a&&!o.hasSelection())&&o.select({rowStart:n[0],rowEnd:i[0],colStart:n[1],colEnd:i[1]}),t.preventDefault()),$(document).on("mousemove",w).on("touchmove",w))}},u=function(t){if(o.hasFocus()){var n=e.getCoords(t.target);n&&e.setEditMode(t.target)}},c=function(e){$(document).unbind("mousemove",w).unbind("touchmove",w)},w=function(t){var i=e.getCoords(t.target);if(t.changedTouches){var l,a,r=t.changedTouches;if(r.length>0){var s=r.item(0);l=s.clientX,a=s.clientY,i=e.getCoords(document.elementFromPoint(l,a))}}!e.isEditing()&&i&&(o.select({rowStart:n[0],rowEnd:i[0],colStart:n[1],colEnd:i[1]}),t.preventDefault())},C=function(t){v.blur();var n=o.hasFocus();if(n){var i=o.hasSelection(),l=e.originCell==e.terminalCell,a=t.keyCode,s=t.ctrlKey,d=t.shiftKey,u=9==a,c=13==a,g=27==a,h=46==a,w=8==a,C=37==a,p=38==a,m=39==a,y=40==a,S=36==a,E=35==a,b=e.editingCell,R=e.isEditing();if((u||c||g||p||y||C&&b&&0==f(b)||m&&b&&f(b)==b.innerText.length)&&(t.preventDefault(),e.exitEditMode()),!e.isEditing())if(s&&65==a)t.preventDefault(),d?o.deselect():o.select();else if(i){var x=!l&&(u||c),M=!d&&!x,T=!x,D=!d&&!x,V=e.getCoords(e.originCell),k=e.getCoords(e.terminalCell);if(g&&!R)o.deselect();else if(h||w)t.preventDefault(),o.hasSelection()&&o.clearSelection();else if(c||u){var $;u?$=r(l?o.getRows():o.getSelectedRows()):c&&($=r(l?o.getCols():o.getSelectedCols()));var A=$.indexOf(l?e.originCell:b);if(l){var H=e.getCoords($[(A+(d?-1:1)).mod($.length)]);o.select({rowStart:H[0],rowEnd:H[0],colStart:H[1],colEnd:H[1]})}else x&&e.setEditMode($[(A+(d?-1:1)).mod($.length)])}else if(C||p||m||y||S||E){var L={x:0,y:0},I=T&&!D?k:V;switch(a){case 35:L.x=o.getColCount()-I[1]-1,s&&(L.y=o.getRowCount()-I[0]-1);break;case 36:L.x=-I[1],s&&(L.y=-I[0]);break;case 37:L.x=s?L.x=-I[1]:-1;break;case 38:L.y=s?L.y=-I[0]:-1;break;case 39:L.x=s?o.getColCount()-I[1]-1:1;break;case 40:L.y=s?o.getRowCount()-I[0]-1:1}if(V&&k){var F=function(e){return!(e[0]<0||e[0]>=o.getRowCount()||e[1]<0||e[1]>=o.getColCount())};if(M){var H=[V[0]+L.y,V[1]+L.x];F(H)&&(V=H)}if(D)k=V;else if(T){var H=[k[0]+L.y,k[1]+L.x];F(H)&&(k=H)}o.select({rowStart:V[0],rowEnd:k[0],colStart:V[1],colEnd:k[1]})}}}else if(u||c||S||E||C||p||m||y){var O=[0,0];E&&(O[1]=o.getColCount()-1,s&&(O[0]=o.getRowCount()-1)),o.select({rowStart:O[0],rowEnd:O[0],colStart:O[1],colEnd:O[1]})}}},p=function(t){var n=o.hasFocus(),i=e.isEditing(),r=o.hasSelection();n&&r&&!i&&e.setEditMode(e.originCell)},m=function(e){h(o),g(o),o.fireEvent("change")};return $(document).on("mousedown",a).on("touchstart",a).on("dblclick",u).on("mouseup",c).on("touchend",c).on("keydown",C).on("keypress",p),e={originCell:null,terminalCell:null,editingCell:null,isEditing:function(){return null!=this.editingCell},setEditMode:function(e){var t=$(e);this.exitEditMode(),o.CellManager.isEditable(e)&&(e.focus(),s(e),t.addClass("ediTable-cell-editing"),t.on("input",m),o.Selection.editingCell=e)},exitEditMode:function(){this.isEditing()&&(this.editingCell.blur(),document.body.focus(),d(),$(this.editingCell).removeClass("ediTable-cell-editing").unbind("input",m),this.editingCell=null)},getCoords:function(e){var t=$(e),n=t.closest("tr > td, tr > th")[0],i=t.closest("tr")[0],r=null;return n&&i&&$.contains(o.table,i)&&(r=[i.rowIndex,n.cellIndex]),r}}}(),c(this),g(this),h(this),$(this.table).addClass("ediTable").focusin(function(e){if(!o.hasSelection()){var t=o.Selection.getCoords(e.target);if(!t)return;e.target.blur(),o.lastClicked=e.target,d(),o.select({rowStart:t[0],rowEnd:t[0],colStart:t[1],colEnd:t[1]})}}),this.lastClicked=null,this.table.addEventListener("dragstart",function(e){e.preventDefault()}),this.table.addEventListener("drop",function(e){e.preventDefault()}),document.addEventListener("copy",i),document.addEventListener("cut",l),document.addEventListener("paste",a)};p.prototype={addEventListener:function(e,t){this.events[e].push(t)},removeEventListener:function(e,t){var n=this.events[e].indexOf(t);-1!=n&&this.events[e].splice(n,1)},fireEvent:function(e){var t=this.events[e],n={};if(t)for(var o=0;o<t.length;o++)t[o](n)},hasFocus:function(){var e=document.activeElement,t=this.lastClicked;return 1==$(e).closest(this.table).length||1==$(t).closest(this.table).length},getRowCount:function(){return this.table.rows.length},getColCount:function(){for(var e=0,t=this.table.rows,n=0;n<t.length;n++)e=Math.max(e,t[n].cells.length);return e},setEditable:function(e,t){"undefined"==typeof e&&(e=!0),"undefined"==typeof t&&(t={}),"undefined"==typeof t.rowStart&&(t.rowStart=0),"undefined"==typeof t.rowEnd&&(t.rowEnd=this.getRowCount()-1),"undefined"==typeof t.colStart&&(t.colStart=0),"undefined"==typeof t.colEnd&&(t.colEnd=this.getColCount()-1);var n=this;t.table=this.table,t.func=function(t){n.CellManager.setEditable(t,e)},l(t)},isEditable:function(e){"undefined"==typeof e&&(e={}),"undefined"==typeof e.rowStart&&(e.rowStart=0),"undefined"==typeof e.rowEnd&&(e.rowEnd=this.getRowCount()-1),"undefined"==typeof e.colStart&&(e.colStart=0),"undefined"==typeof e.colEnd&&(e.colEnd=this.getColCount()-1);var t=!0,n=this;return e.table=this.table,e.func=function(e){n.CellManager.isEditable(e)||(t=!1)},l(e),t},setHeader:function(e,t){"undefined"==typeof e&&(e=!0),"undefined"==typeof t&&(t={}),"undefined"==typeof t.rowStart&&(t.rowStart=0),"undefined"==typeof t.rowEnd&&(t.rowEnd=this.getRowCount()-1),"undefined"==typeof t.colStart&&(t.colStart=0),"undefined"==typeof t.colEnd&&(t.colEnd=this.getColCount()-1);var n=this;t.table=this.table,t.func=function(t){n.CellManager.setHeader(t,e)},l(t)},isHeader:function(e){"undefined"==typeof e&&(e={}),"undefined"==typeof e.rowStart&&(e.rowStart=0),"undefined"==typeof e.rowEnd&&(e.rowEnd=this.getRowCount()-1),"undefined"==typeof e.colStart&&(e.colStart=0),"undefined"==typeof e.colEnd&&(e.colEnd=this.getColCount()-1);var t=!0,n=this;return e.table=this.table,e.func=function(e){n.CellManager.isHeader(e)||(t=!1)},l(e),t},select:function(e){"undefined"==typeof e&&(e={}),"undefined"==typeof e.rowStart&&(e.rowStart=0),"undefined"==typeof e.rowEnd&&(e.rowEnd=this.getRowCount()-1),"undefined"==typeof e.colStart&&(e.colStart=0),"undefined"==typeof e.colEnd&&(e.colEnd=this.getColCount()-1);var t=this;this.deselect(),e.table=this.table,e.func=function(e){t.CellManager.select(e)};var n=l(e);this.Selection.originCell=n.first,this.Selection.terminalCell=n.last;var t=this;if(function(){for(var n=(t.table,t.table.rows),o=t.getRowCount(),i=t.getColCount(),r=t.CellManager,l=0;o>l;l++)for(var a=t.table.rows[l],s=0;i>s;s++){var f=a.cells[s],d=$(f);r.isSelected(f)&&(d.toggleClass("ediTable-cell-selected-top",0==l||!r.isSelected(n[l-1].cells[s])),d.toggleClass("ediTable-cell-selected-bottom",l==o-1||!r.isSelected(n[l+1].cells[s])),d.toggleClass("ediTable-cell-selected-left",0==s||!r.isSelected(a.cells[s-1])),d.toggleClass("ediTable-cell-selected-right",s==i-1||!r.isSelected(a.cells[s+1])))}}(),this.options.scrollSelectionIntoView){var o=this.Selection.originCell,i=this.Selection.terminalCell;C(o!=i?i:o)}},deselect:function(e){"undefined"==typeof e&&(e={}),"undefined"==typeof e.rowStart&&(e.rowStart=0),"undefined"==typeof e.rowEnd&&(e.rowEnd=this.getRowCount()-1),"undefined"==typeof e.colStart&&(e.colStart=0),"undefined"==typeof e.colEnd&&(e.colEnd=this.getColCount()-1);var t=this;e.table=this.table,e.func=function(e){t.CellManager.deselect(e)},l(e)},setRowValues:function(e,t){if(!a(e))throw new TypeError("values parameter must be 2D Array");"undefined"==typeof t&&(t={}),"undefined"==typeof t.rowStart&&(t.rowStart=0),"undefined"==typeof t.colStart&&(t.colStart=0);for(var n=t.rowStart+e.length,o=this.options.maxRows,i=this.getRowCount(),r=n-i;(-1==o||o>i)&&r>0;)i=this.getRowCount(),r=n-i,this.insertRow(i);for(var l=t.colStart+e[0].length,s=this.options.maxCols,f=this.getColCount(),d=l-f;(-1==s||s>f)&&d>0;)f=this.getColCount(),d=l-f,this.insertCol(f);for(var u=this.table.rows,c=0;c<e.length&&c<u.length-t.rowStart;c++)for(var w=u[c+t.rowStart],C=0;C<e[c].length&&C<w.cells.length-t.colStart;C++){var p=w.cells[C+t.colStart];this.CellManager.setValue(p,e[c][C])}h(this),g(this),this.fireEvent("change")},setColValues:function(t,n){if(!a(t))throw new TypeError("values parameter must be 2D Array");"undefined"==typeof n&&(n={}),"undefined"==typeof n.rowStart&&(n.rowStart=0),"undefined"==typeof n.colStart&&(n.colStart=0),t=e(t),0==t.length&&(t[0]=[]),this.setRowValues(t,n)},clear:function(e){"undefined"==typeof e&&(e={}),"undefined"==typeof e.rowStart&&(e.rowStart=0),"undefined"==typeof e.rowEnd&&(e.rowEnd=this.getRowCount()-1),"undefined"==typeof e.colStart&&(e.colStart=0),"undefined"==typeof e.colEnd&&(e.colEnd=this.getColCount()-1);var t=this;e.table=this.table,e.func=function(e){t.CellManager.clear(e)},l(e),h(this),this.fireEvent("change")},clearSelection:function(){var e=this.Selection,t=e.getCoords(e.originCell),n=e.getCoords(e.terminalCell);t&&n&&this.clear({rowStart:t[0],colStart:t[1],rowEnd:n[0],colEnd:n[1]})},isClear:function(e){"undefined"==typeof e&&(e={}),"undefined"==typeof e.rowStart&&(e.rowStart=0),"undefined"==typeof e.rowEnd&&(e.rowEnd=this.getRowCount()-1),"undefined"==typeof e.colStart&&(e.colStart=0),"undefined"==typeof e.colEnd&&(e.colEnd=this.getColCount()-1);var t=!0;return e.table=this.table,e.func=function(e){ctx.CellManager.isClear(e)||(t=!1)},l(e),t},hasSelection:function(){return this.getSelectedRows().length>0},getRow:function(e,t){"undefined"==typeof t&&(t={}),"undefined"==typeof t.colStart&&(t.colStart=0),"undefined"==typeof t.colEnd&&(t.colEnd=this.getColCount()-1);var n=[],i=this.table.rows[e];return o({arr:i.cells,start:t.colStart,end:t.colEnd,func:function(e){n.push(e)}}),n},getRows:function(e){"undefined"==typeof e&&(e={}),"undefined"==typeof e.rowStart&&(e.rowStart=0),"undefined"==typeof e.rowEnd&&(e.rowEnd=this.getRowCount()-1),"undefined"==typeof e.colStart&&(e.colStart=0),"undefined"==typeof e.colEnd&&(e.colEnd=this.getColCount()-1);var t=this.table.rows,n=[],i=this;return o({arr:t,start:e.rowStart,end:e.rowEnd,func:function(t,o){n.push(i.getRow(o,e))}}),n},getSelectedRows:function(){var e=this;return this.getRows().map(function(t){return e.VectorManager.getSelection(t)}).filter(function(e){return e.length>0})},getRowValues:function(e){var t=this;return this.getRows(e).map(function(e){return t.VectorManager.getValues(e)})},getSelectedRowValues:function(){var e=this;return this.getSelectedRows().map(function(t){return e.VectorManager.getValues(t)})},getCol:function(e,t){"undefined"==typeof t&&(t={}),"undefined"==typeof t.rowStart&&(t.rowStart=0),"undefined"==typeof t.rowEnd&&(t.rowEnd=this.getRowCount()-1);var n=[];return t.table=this.table,t.colStart=e,t.colEnd=e,t.func=function(e){n.push(e)},l(t),n},getCols:function(t){return e(this.getRows(t))},getSelectedCols:function(){return e(this.getSelectedRows())},getColValues:function(t){return e(this.getRowValues(t))},getSelectedColValues:function(){return e(this.getSelectedRowValues())},canInsertRow:function(){return-1==this.options.maxRows||this.table.rows.length<this.options.maxRows},canInsertCol:function(){return-1==this.options.maxCols||this.table.rows[0].cells.length<this.options.maxCols},rowsCanGrow:function(){return this.options.growRows&&this.canInsertRow()},colsCanGrow:function(){var e=this.options;return e.growCols&&this.canInsertCol()},insertRow:function(e){if(this.canInsertRow())for(var t=this.VectorManager,n=this.getCols(),o=this.table.insertRow(e),i=e>0?this.getRow(e-1):null,r=e<this.getRowCount()-1?this.getRow(e+1):null,l=(i?t.isEditable(i):!0)&&(r?t.isEditable(r):!0),a=(i?t.isHeader(i):!0)&&(r?t.isHeader(r):!0),s=0;s<this.getColCount();s++){var f=o.insertCell(s),d=n[s],u=t.isEditable(d),c=t.isHeader(d);this.CellManager.setEditable(f,l||u),this.CellManager.setHeader(f,a||c)}},insertCol:function(e){if(this.canInsertCol())for(var t=this.VectorManager,n=this.getRows(),o=e>0?this.getCol(e-1):null,i=e<this.getColCount()-1?this.getCol(e+1):null,r=(o?t.isEditable(o):!0)&&(i?t.isEditable(i):!0),l=(o?t.isHeader(o):!0)&&(i?t.isHeader(i):!0),a=0;a<this.getRowCount();a++){var s=this.table.rows[a].insertCell(e),f=n[a],d=t.isEditable(f),u=t.isHeader(f);this.CellManager.setEditable(s,r||d),this.CellManager.setHeader(s,l||u)}},removeRow:function(e){this.table.deleteRow(e)},removeCol:function(e){for(var t=this.table.rows,n=0;n<t.length;n++){var o=t[n];o.deleteCell(e)}}},window.EdiTable=p;var v=document.createElement("input");v.defaultValue="ediTable",$(v).prop("type","text").css({position:"fixed",opacity:"0"}),document.body.appendChild(v)}();
