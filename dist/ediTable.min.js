!function(){"use strict";function e(e){return e=e[0].map(function(t,n){return e.map(function(e){return e[n]})})}function t(e){return Array.apply(null,e)}function n(e){for(var n=e.rows,o=[],i=0;i<n.length;i++)o[i]=t(n[i].cells);return o}function o(e){if("undefined"!=typeof e&&"undefined"!=typeof e.func&&"undefined"!=typeof e.arr&&0!=e.arr.length){"undefined"==typeof e.start&&(e.start=0),"undefined"==typeof e.end&&(e.end=e.arr.length-1),"undefined"==typeof e.dir&&(e.dir=e.end>e.start?1:-1),"undefined"==typeof e.funcContext&&(e.funcContext=null);for(var t=Math.min(e.start,e.end),n=Math.max(e.start,e.end),o=e.dir>0?t:n;o>=t&&n>=o;)e.func.apply(e.funcContext,[e.arr[o],o]),o+=e.dir}}function i(e){"undefined"!=typeof e&&"undefined"!=typeof e.func&&"undefined"!=typeof e.arr&&0!=e.arr.length&&a(e.arr)&&("undefined"==typeof e.rowStart&&(e.rowStart=0),"undefined"==typeof e.colStart&&(e.colStart=0),"undefined"==typeof e.rowEnd&&(e.rowEnd=e.arr.length-1),"undefined"==typeof e.colEnd&&(e.colEnd=e.arr[0].length-1),"undefined"==typeof e.rowDir&&(e.rowDir=e.rowEnd>e.rowStart?1:-1),"undefined"==typeof e.colDir&&(e.colDir=e.colEnd>e.colStart?1:-1),"undefined"==typeof e.funcContext&&(e.funcContext=null),o({arr:e.arr,start:e.rowStart,end:e.rowEnd,dir:e.rowDir,func:function(t){o({arr:t,start:e.colStart,end:e.colEnd,dir:e.colDir,func:function(t){e.func.apply(e.funcContext,[t])}})}}))}function r(e,t){var l,n=Object.prototype.toString,o="[object Array]",i=[],r=t&&e||e.slice();if(!e.length)return i;l=r.pop();do n.call(l)===o?r.push.apply(r,l):i.push(l);while(r.length&&void 0!==(l=r.pop()));return i.reverse(),i}function l(e){"undefined"!=typeof e.table&&(e.arr=n(e.table));var t=null,o=null,r=e.func,l=function(e,n){o=e,t||(t=e),r(e,n)};return e.func=l,i(e),{first:t,last:o}}function a(e){if(!(e instanceof Array))return!1;for(var t=e.length>0&&e[0]instanceof Array?e[0].length:0,n=1;n<e.length;n++){var o=e[n];if(!(o instanceof Array))return!1;if(o.length!=t)return!1}return!0}function s(e){if(document.body.createTextRange){var t=document.body.createTextRange();t.moveToElementText(e),t.select()}else if(window.getSelection){var n=window.getSelection(),t=document.createRange();t.selectNodeContents(e),n.removeAllRanges(),n.addRange(t)}}function f(e){var o,i,t=0;if(window.getSelection)o=window.getSelection(),o.rangeCount&&(i=o.getRangeAt(0),i.commonAncestorContainer.parentNode==e&&(t=i.endOffset));else if(document.selection&&document.selection.createRange&&(i=document.selection.createRange(),i.parentElement()==e)){var r=document.createElement("span");e.insertBefore(r,e.firstChild);var l=i.duplicate();l.moveToElementText(r),l.setEndPoint("EndToEnd",i),t=l.text.length}return t}function d(){document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges()}function u(e){for(var t=$("tr",e).toArray(),n=t.map(function(e){return e.cells.length}),o=Math.max.apply(null,n),i=0;i<t.length;i++){var r=t[i],l=$("td",r).toArray(),a=$("th",r).toArray(),s=o-(l.length+a.length);if(s>0){for(var f=0==l.length?"th":"td",d=new Array(s),u=0;s>u;u++)d[u]=document.createElement(f);$(r).append(d)}}}function c(e){var t=e.options;if(t.maxRows>-1)for(;e.getRowCount()>t.maxRows;)e.removeRow(e.getRowCount()-1);if(t.maxCols>-1)for(;e.getColCount()>t.maxCols;)e.removeCol(e.getColCount()-1);for(;e.getRowCount()<t.minRows;)e.insertRow(e.getRowCount());for(;e.getColCount()<t.minCols;)e.insertCol(e.getColCount())}function h(e){var n=(e.options,e.VectorManager),o=n.isClear(e.getRow(e.getRowCount()-1));!o&&e.rowsCanGrow()&&e.insertRow(e.getRowCount());var i=n.isClear(e.getCol(e.getColCount()-1));!i&&e.colsCanGrow()&&e.insertCol(e.getColCount())}function g(e){var t=e.options,n=e.VectorManager;if(t.shrinkRows)if(t.rowsAllowMiddleShrink)for(var o=0;e.getRowCount()>t.minRows;){var i=e.getRowCount()-(t.growRows?2:1),r=i-o;if(r>=0&&n.isClear(e.getRow(r))?e.removeRow(r):o++,0==r)break}else for(;e.getRowCount()>t.minRows;){var r=e.getRowCount()-(t.growRows?2:1);if(!(r>=0&&n.isClear(e.getRow(r))))break;e.removeRow(r)}if(t.shrinkCols)if(t.colsAllowMiddleShrink)for(var o=0;e.getColCount()>t.minCols;){var l=e.getColCount()-(t.growCols?2:1),a=l-o;if(a>=0&&n.isClear(e.getCol(a))?e.removeCol(a):o++,0==a)break}else for(;e.getColCount()>t.minCols;){var a=e.getColCount()-(t.growCols?2:1);if(!(a>=0&&n.isClear(e.getCol(a))))break;e.removeCol(a)}}function w(e){"function"==typeof jQuery&&e instanceof jQuery&&(e=e[0]);var t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=$(window).height()&&t.right<=$(window).width()}function C(e){w(e)||e.scrollIntoView()}Number.prototype.mod=function(e){return(this%e+e)%e};var v=function(t,n){function o(e){"undefined"==typeof e.minRows&&(e.minRows=1),"undefined"==typeof e.minCols&&(e.minCols=1),"undefined"==typeof e.maxRows&&(e.maxRows=-1),"undefined"==typeof e.maxCols&&(e.maxCols=-1),"undefined"==typeof e.growRows&&(e.growRows=!1),"undefined"==typeof e.growCols&&(e.growCols=!1),"undefined"==typeof e.shrinkRows&&(e.shrinkRows=!1),"undefined"==typeof e.shrinkCols&&(e.shrinkCols=!1),"undefined"==typeof e.rowsAllowMiddleShrink&&(e.rowsAllowMiddleShrink=!1),"undefined"==typeof e.colsAllowMiddleShrink&&(e.colsAllowMiddleShrink=!1),"undefined"==typeof e.copyAsHTML&&(e.copyAsHTML=!0),"undefined"==typeof e.pasteAsHTML&&(e.pasteAsHTML=!1),"undefined"==typeof e.rotateWidePaste&&(e.rotateWidePaste=!1),"undefined"==typeof e.scrollSelectionIntoView&&(e.scrollSelectionIntoView=!0),e.minRows<0&&(e.minRows=0),e.minCols<0&&(e.minCols=0),-1!=e.maxRows&&e.minRows>e.maxRows&&(e.maxRows=e.minRows),-1!=e.maxCols&&e.minCols>e.maxCols&&(e.maxCols=e.minCols)}function i(e){var t,n="none"==a.css("display");return a.hide(),t=document.elementFromPoint(e.clientX,e.clientY),n||a.show(),t}function w(e){if(l.hasFocus()&&!l.Selection.isEditing()){if(l.options.copyAsHTML){for(var t=l.getSelectedRows(),n=document.createElement("table"),o=0;o<t.length;o++){for(var i=t[o],r=document.createElement("tr"),a=0;a<i.length;a++){var s=i[a];r.appendChild($(s).clone()[0])}n.appendChild(r)}e.clipboardData.setData("text/html",n.outerHTML)}for(var f="",d=l.getSelectedRowValues(),o=0;o<d.length;o++){for(var u=d[o],a=0;a<u.length;a++){var c=u[a];f+=c,a!=u.length-1&&(f+="	")}o!=d.length-1&&(f+="\n")}e.clipboardData.setData("text/plain",f),e.preventDefault()}}function C(e){l.hasFocus()&&!l.Selection.isEditing()&&(w(e),l.clearSelection())}function v(t){if(l.hasFocus())if(l.Selection.isEditing()){if(!l.options.pasteAsHTML){t.preventDefault();var S=t.clipboardData.getData("text/plain");document.execCommand("insertHTML",!1,S)}}else{t.preventDefault();var n,o,i=[],r=0,a=t.clipboardData.getData("text/html"),s=t.clipboardData.getData("text/plain"),f=l.getSelectedRows();if(a&&""!=a){if(window.DOMParser){var d=new DOMParser;n=d.parseFromString(a,"text/html")}else n=document.implementation.createHTMLDocument(),n.write(a);var u=n.getElementsByTagName("table");o=u.length>0?u[0]:null}if(o)for(var c=o.rows,h=0;h<c.length;h++){var g=c[h],w=g.cells;w.length>r&&(r=w.length),i[h]=[];for(var C=0;C<w.length;C++){var v=w[C];i[h][C]=v.innerText}}else if(s)for(var c=s.split("\n"),h=0;h<c.length;h++){var g=c[h],p=g.split("	");p.length>r&&(r=p.length),i[h]=[];for(var C=0;C<p.length;C++){var S=p[C];i[h][C]=S}}if(i.length>0&&f.length>0){var m=l.Selection.getCoords(f[0][0]);if(l.options.rotateWidePaste){var E=-1==l.options.maxCols&&r+m[0]>l.getColCount()||l.options.maxCols>-1&&r+m[0]>l.options.maxCols,y=r>i.length,b=l.colsCanGrow();!b&&y&&E&&(i=e(i))}l.setRowValues(i,{rowStart:m[0],colStart:m[1]})}}}var l=this;this.table=t,this.options=n||{},this.events={change:[]},u(this.table),o(this.options);var a=$("<div contenteditable></div>").css({cursor:"default",display:"table-row",opacity:"0",position:"absolute","z-index":"1",top:"0",bottom:"0",width:"100%"}).text("ediTable");$(this.table).css({position:"relative"}).append(a),this.CellManager={setEditable:function(e,t){"undefined"==typeof t&&(t=!0),e.contentEditable=t},isEditable:function(e){return e.isContentEditable||"true"==e.contentEditable},setHeader:function(e,t){if("undefined"==typeof t&&(t=!0),t!=this.isHeader(e)){var n=t?"th":"td",o=e,i=$(o).contents().detach(),r=document.createElement(n);$.each(o.attributes,function(e){$(r).attr(o.attributes[e].name,o.attributes[e].value)}),$(r).append(i),$(o).replaceWith(r)}},isHeader:function(e){return"th"==e.tagName.toLowerCase()},select:function(e){$(e).addClass("ediTable-cell-selected")},deselect:function(e){$(e).removeClass("ediTable-cell-selected").removeClass("ediTable-cell-selected-left").removeClass("ediTable-cell-selected-right").removeClass("ediTable-cell-selected-top").removeClass("ediTable-cell-selected-bottom")},isSelected:function(e){return $(e).hasClass("ediTable-cell-selected")},getValue:function(e){return e.innerText},setValue:function(e,t){this.isEditable(e)&&(l.options.pasteAsHTML?$(e).html(t):$(e).text(t))},clear:function(e){this.setValue(e,"")},isClear:function(e){return""==e.innerHTML}},this.VectorManager={getSelection:function(e){return e.filter(function(e){return l.CellManager.isSelected(e)})},getValues:function(e){return e.map(function(e){return l.CellManager.getValue(e)})},isHeader:function(e){for(var t=0;t<e.length;t++)if(!l.CellManager.isHeader(e[t]))return!1;return!0},isEditable:function(e){for(var t=0;t<e.length;t++)if(!l.CellManager.isEditable(e[t]))return!1;return!0},isClear:function(e){for(var t=0;t<e.length;t++)if(!l.CellManager.isClear(e[t]))return!1;return!0}},this.Selection=function(){var e,o,n=($(l.table),[]),u=function(){var e=(new Date).getTime(),t=e-o;return o=(new Date).getTime(),600>t&&t>0},c=function(t){var o=i(t),r=e.getCoords(o);l.lastClicked=o;var a=l.hasFocus();if(r&&a||(l.deselect(),e.exitEditMode()),a&&$.contains(l.table,o)){if("touchstart"==t.type&&u())return void C(t);var s=3==t.which;if(r){var f=!s||s&&!l.hasSelection();(!l.hasSelection()||!t.shiftKey&&l.hasSelection())&&(n=r),e.isEditing()?o!=e.editingCell&&(e.exitEditMode(),f&&l.select({rowStart:n[0],rowEnd:r[0],colStart:n[1],colEnd:r[1]}),t.preventDefault()):f&&l.select({rowStart:n[0],rowEnd:r[0],colStart:n[1],colEnd:r[1]}),f&&$(document).on("mousemove",p).on("touchmove",p)}}},w=function(t){!e.isEditing()&&$.contains(l.table,t.target)&&s(a[0])},C=function(t){if(l.hasFocus()){var n=i(t),o=e.getCoords(n);o&&e.setEditMode(n)}},v=function(){$(document).unbind("mousemove",p).unbind("touchmove",p)},p=function(t){var o=e.getCoords(i(t));if(t.changedTouches){var a,s,r=t.changedTouches;if(r.length>0){var f=r.item(0);a=f.clientX,s=f.clientY,o=e.getCoords(document.elementFromPoint(a,s))}}!e.isEditing()&&o&&(l.select({rowStart:n[0],rowEnd:o[0],colStart:n[1],colEnd:o[1]}),t.preventDefault())},S=function(t){a.blur();var n=l.hasFocus();if(n){var o=l.hasSelection(),i=e.originCell==e.terminalCell,s=t.keyCode,d=t.ctrlKey,u=t.shiftKey,c=9==s,h=13==s,g=27==s,w=46==s,C=8==s,v=37==s,p=38==s,S=39==s,m=40==s,E=36==s,y=35==s,b=e.editingCell,R=e.isEditing();if((c||h||g||p||m||v&&b&&0==f(b)||S&&b&&f(b)==b.innerText.length)&&(t.preventDefault(),e.exitEditMode()),!e.isEditing())if(d&&65==s)t.preventDefault(),u?l.deselect():l.select();else if(o){if(93==t.keyCode)return void e.originCell.focus();var x=!i&&(c||h),M=!u&&!x,T=!x,$=!u&&!x,D=e.getCoords(e.originCell),k=e.getCoords(e.terminalCell);if(g&&!R)l.deselect();else if(w||C)t.preventDefault(),l.hasSelection()&&l.clearSelection();else if(h||c){var V;c?V=r(i?l.getRows():l.getSelectedRows()):h&&(V=r(i?l.getCols():l.getSelectedCols()));var A=V.indexOf(i?e.originCell:b);if(i){var H=e.getCoords(V[(A+(u?-1:1)).mod(V.length)]);l.select({rowStart:H[0],rowEnd:H[0],colStart:H[1],colEnd:H[1]})}else x&&e.setEditMode(V[(A+(u?-1:1)).mod(V.length)])}else if(v||p||S||m||E||y){var L={x:0,y:0},I=T&&!$?k:D;switch(s){case 35:L.x=l.getColCount()-I[1]-1,d&&(L.y=l.getRowCount()-I[0]-1);break;case 36:L.x=-I[1],d&&(L.y=-I[0]);break;case 37:L.x=d?L.x=-I[1]:-1;break;case 38:L.y=d?L.y=-I[0]:-1;break;case 39:L.x=d?l.getColCount()-I[1]-1:1;break;case 40:L.y=d?l.getRowCount()-I[0]-1:1}if(D&&k){var F=function(e){return!(e[0]<0||e[0]>=l.getRowCount()||e[1]<0||e[1]>=l.getColCount())};if(M){var H=[D[0]+L.y,D[1]+L.x];F(H)&&(D=H)}if($)k=D;else if(T){var H=[k[0]+L.y,k[1]+L.x];F(H)&&(k=H)}l.select({rowStart:D[0],rowEnd:k[0],colStart:D[1],colEnd:k[1]})}}}else if(c||h||E||y||v||p||S||m){var P=[0,0];y&&(P[1]=l.getColCount()-1,d&&(P[0]=l.getRowCount()-1)),l.select({rowStart:P[0],rowEnd:P[0],colStart:P[1],colEnd:P[1]})}}},m=function(){var n=l.hasFocus(),o=e.isEditing(),i=l.hasSelection();n&&i&&!o&&e.setEditMode(e.originCell)},E=function(e){var t=l.Selection.getCoords(e.target);g(l),h(l),l.fireEvent("change",{rowStart:t[0],rowEnd:t[0],colStart:t[1],colEnd:t[1]})};return $(document).on("mousedown",c).on("touchstart",c).on("contextmenu",w).on("dblclick",C).on("mouseup",v).on("touchend",v).on("keydown",S).on("keypress",m),e={originCell:null,terminalCell:null,editingCell:null,isEditing:function(){return null!=this.editingCell},setEditMode:function(e){var t=$(e);this.exitEditMode(),l.CellManager.isEditable(e)&&(a.hide(),e.focus(),s(e),t.addClass("ediTable-cell-editing"),t.on("input",E),l.Selection.editingCell=e)},exitEditMode:function(){this.isEditing()&&(this.editingCell.blur(),document.body.focus(),d(),$(this.editingCell).removeClass("ediTable-cell-editing").unbind("input",E),this.editingCell=null,a.show())},getCoords:function(e){if(!$.contains(l.table,e))return null;var t=$(e),n=t.closest("tr > td, tr > th")[0],o=t.closest("tr")[0],i=null;return n&&o&&$.contains(l.table,o)&&(i=[o.rowIndex,n.cellIndex]),i}}}(),c(this),h(this),g(this),$(this.table).addClass("ediTable").focusin(function(e){if(!l.hasSelection()){var t=l.Selection.getCoords(e.target);if(!t)return;e.target.blur(),l.lastClicked=e.target,d(),l.select({rowStart:t[0],rowEnd:t[0],colStart:t[1],colEnd:t[1]})}}),this.lastClicked=null,this.table.addEventListener("dragstart",function(e){e.preventDefault()}),this.table.addEventListener("drop",function(e){e.preventDefault()}),document.addEventListener("copy",w),document.addEventListener("cut",C),document.addEventListener("paste",v)};v.prototype={addEventListener:function(e,t){this.events[e].push(t)},removeEventListener:function(e,t){var n=this.events[e].indexOf(t);-1!=n&&this.events[e].splice(n,1)},fireEvent:function(e,t){var n=this.events[e];if(n)for(var o=0;o<n.length;o++)n[o](t)},hasFocus:function(){var e=document.activeElement,t=this.lastClicked;return 1==$(e).closest(this.table).length||1==$(t).closest(this.table).length||this.hasSelection()},getRowCount:function(){return this.table.rows.length},getColCount:function(){for(var e=0,t=this.table.rows,n=0;n<t.length;n++)e=Math.max(e,t[n].cells.length);return e},setEditable:function(e,t){"undefined"==typeof e&&(e=!0),"undefined"==typeof t&&(t={}),"undefined"==typeof t.rowStart&&(t.rowStart=0),"undefined"==typeof t.rowEnd&&(t.rowEnd=this.getRowCount()-1),"undefined"==typeof t.colStart&&(t.colStart=0),"undefined"==typeof t.colEnd&&(t.colEnd=this.getColCount()-1);var n=this;t.table=this.table,t.func=function(t){n.CellManager.setEditable(t,e)},l(t)},isEditable:function(e){"undefined"==typeof e&&(e={}),"undefined"==typeof e.rowStart&&(e.rowStart=0),"undefined"==typeof e.rowEnd&&(e.rowEnd=this.getRowCount()-1),"undefined"==typeof e.colStart&&(e.colStart=0),"undefined"==typeof e.colEnd&&(e.colEnd=this.getColCount()-1);var t=!0,n=this;return e.table=this.table,e.func=function(e){n.CellManager.isEditable(e)||(t=!1)},l(e),t},setHeader:function(e,t){"undefined"==typeof e&&(e=!0),"undefined"==typeof t&&(t={}),"undefined"==typeof t.rowStart&&(t.rowStart=0),"undefined"==typeof t.rowEnd&&(t.rowEnd=this.getRowCount()-1),"undefined"==typeof t.colStart&&(t.colStart=0),"undefined"==typeof t.colEnd&&(t.colEnd=this.getColCount()-1);var n=this;t.table=this.table,t.func=function(t){n.CellManager.setHeader(t,e)},l(t)},isHeader:function(e){"undefined"==typeof e&&(e={}),"undefined"==typeof e.rowStart&&(e.rowStart=0),"undefined"==typeof e.rowEnd&&(e.rowEnd=this.getRowCount()-1),"undefined"==typeof e.colStart&&(e.colStart=0),"undefined"==typeof e.colEnd&&(e.colEnd=this.getColCount()-1);var t=!0,n=this;return e.table=this.table,e.func=function(e){n.CellManager.isHeader(e)||(t=!1)},l(e),t},select:function(e){"undefined"==typeof e&&(e={}),"undefined"==typeof e.rowStart&&(e.rowStart=0),"undefined"==typeof e.rowEnd&&(e.rowEnd=this.getRowCount()-1),"undefined"==typeof e.colStart&&(e.colStart=0),"undefined"==typeof e.colEnd&&(e.colEnd=this.getColCount()-1);var t=this;this.deselect(),e.table=this.table,e.func=function(e){t.CellManager.select(e)};var n=l(e);this.Selection.originCell=n.first,this.Selection.terminalCell=n.last;var t=this;if(function(){for(var n=(t.table,t.table.rows),o=t.getRowCount(),i=t.getColCount(),r=t.CellManager,l=0;o>l;l++)for(var a=t.table.rows[l],s=0;i>s;s++){var f=a.cells[s],d=$(f);r.isSelected(f)&&(d.toggleClass("ediTable-cell-selected-top",0==l||!r.isSelected(n[l-1].cells[s])),d.toggleClass("ediTable-cell-selected-bottom",l==o-1||!r.isSelected(n[l+1].cells[s])),d.toggleClass("ediTable-cell-selected-left",0==s||!r.isSelected(a.cells[s-1])),d.toggleClass("ediTable-cell-selected-right",s==i-1||!r.isSelected(a.cells[s+1])))}}(),this.options.scrollSelectionIntoView){var o=this.Selection.originCell,i=this.Selection.terminalCell;C(o!=i?i:o)}},deselect:function(e){"undefined"==typeof e&&(e={}),"undefined"==typeof e.rowStart&&(e.rowStart=0),"undefined"==typeof e.rowEnd&&(e.rowEnd=this.getRowCount()-1),"undefined"==typeof e.colStart&&(e.colStart=0),"undefined"==typeof e.colEnd&&(e.colEnd=this.getColCount()-1);var t=this;e.table=this.table,e.func=function(e){t.CellManager.deselect(e)},l(e)},setRowValues:function(e,t){if(!a(e))throw new TypeError("values parameter must be 2D Array");"undefined"==typeof t&&(t={}),"undefined"==typeof t.rowStart&&(t.rowStart=0),"undefined"==typeof t.colStart&&(t.colStart=0),"undefined"==typeof t.silent&&(t.silent=!1);for(var n=t.rowStart+e.length,o=this.options.maxRows,i=this.getRowCount(),r=n-i;(-1==o||o>i)&&r>0&&this.options.growRows;)i=this.getRowCount(),r=n-i,this.insertRow(i);for(var l=t.colStart+e[0].length,s=this.options.maxCols,f=this.getColCount(),d=l-f;(-1==s||s>f)&&d>0&&this.options.growCols;)f=this.getColCount(),d=l-f,this.insertCol(f);for(var u=this.table.rows,n=0,l=0,c=0;c<e.length&&c<u.length-t.rowStart;c++){for(var w=c+t.rowStart,C=u[w],v=0;v<e[c].length&&v<C.cells.length-t.colStart;v++){var p=v+t.colStart,S=C.cells[p];this.CellManager.setValue(S,e[c][v]),l=Math.max(l,p)}n=Math.max(n,w)}g(this),h(this),t.silent||this.fireEvent("change",{rowStart:t.rowStart,rowEnd:n,colStart:t.colStart,colEnd:l})},setColValues:function(t,n){if(!a(t))throw new TypeError("values parameter must be 2D Array");"undefined"==typeof n&&(n={}),"undefined"==typeof n.rowStart&&(n.rowStart=0),"undefined"==typeof n.colStart&&(n.colStart=0),"undefined"==typeof n.silent&&(n.silent=!1),t=e(t),0==t.length&&(t[0]=[]),this.setRowValues(t,n)},clear:function(e){"undefined"==typeof e&&(e={}),"undefined"==typeof e.rowStart&&(e.rowStart=0),"undefined"==typeof e.rowEnd&&(e.rowEnd=this.getRowCount()-1),"undefined"==typeof e.colStart&&(e.colStart=0),"undefined"==typeof e.colEnd&&(e.colEnd=this.getColCount()-1),"undefined"==typeof e.silent&&(e.silent=!1);var t=this;e.table=this.table,e.func=function(e){t.CellManager.clear(e)},l(e),g(this),e.silent||this.fireEvent("change",{rowStart:e.rowStart,rowEnd:e.rowEnd,colStart:e.colStart,colEnd:e.colEnd})},clearSelection:function(){var e=this.Selection,t=e.getCoords(e.originCell),n=e.getCoords(e.terminalCell);t&&n&&this.clear({rowStart:t[0],colStart:t[1],rowEnd:n[0],colEnd:n[1]})},isClear:function(e){"undefined"==typeof e&&(e={}),"undefined"==typeof e.rowStart&&(e.rowStart=0),"undefined"==typeof e.rowEnd&&(e.rowEnd=this.getRowCount()-1),"undefined"==typeof e.colStart&&(e.colStart=0),"undefined"==typeof e.colEnd&&(e.colEnd=this.getColCount()-1);var t=!0;return e.table=this.table,e.func=function(e){ctx.CellManager.isClear(e)||(t=!1)},l(e),t},hasSelection:function(){return this.getSelectedRows().length>0},getSelectionBounds:function(){var e=this.Selection,t=e.getCoords(e.originCell),n=e.getCoords(e.terminalCell);return{origin:t,terminal:n}},getRow:function(e,t){"undefined"==typeof t&&(t={}),"undefined"==typeof t.colStart&&(t.colStart=0),"undefined"==typeof t.colEnd&&(t.colEnd=this.getColCount()-1);var n=[],i=this.table.rows[e];return o({arr:i.cells,start:t.colStart,end:t.colEnd,func:function(e){n.push(e)}}),n},getRows:function(e){"undefined"==typeof e&&(e={}),"undefined"==typeof e.rowStart&&(e.rowStart=0),"undefined"==typeof e.rowEnd&&(e.rowEnd=this.getRowCount()-1),"undefined"==typeof e.colStart&&(e.colStart=0),"undefined"==typeof e.colEnd&&(e.colEnd=this.getColCount()-1);var t=this.table.rows,n=[],i=this;return o({arr:t,start:e.rowStart,end:e.rowEnd,func:function(t,o){n.push(i.getRow(o,e))}}),n},getSelectedRows:function(){var e=this;return this.getRows().map(function(t){return e.VectorManager.getSelection(t)}).filter(function(e){return e.length>0})},getRowValues:function(e){var t=this;return this.getRows(e).map(function(e){return t.VectorManager.getValues(e)})},getSelectedRowValues:function(){var e=this;return this.getSelectedRows().map(function(t){return e.VectorManager.getValues(t)})},getCol:function(e,t){"undefined"==typeof t&&(t={}),"undefined"==typeof t.rowStart&&(t.rowStart=0),"undefined"==typeof t.rowEnd&&(t.rowEnd=this.getRowCount()-1);var n=[];return t.table=this.table,t.colStart=e,t.colEnd=e,t.func=function(e){n.push(e)},l(t),n},getCols:function(t){return e(this.getRows(t))},getSelectedCols:function(){return e(this.getSelectedRows())},getColValues:function(t){return e(this.getRowValues(t))},getSelectedColValues:function(){return e(this.getSelectedRowValues())},canInsertRow:function(){return-1==this.options.maxRows||this.table.rows.length<this.options.maxRows},canInsertCol:function(){return-1==this.options.maxCols||this.table.rows[0].cells.length<this.options.maxCols},rowsCanGrow:function(){return this.options.growRows&&this.canInsertRow()},colsCanGrow:function(){var e=this.options;return e.growCols&&this.canInsertCol()},insertRow:function(e){if(this.canInsertRow())for(var t=this.VectorManager,n=this.getCols(),o=this.table.insertRow(e),i=e>0?this.getRow(e-1):null,r=e<this.getRowCount()-1?this.getRow(e+1):null,l=(i?t.isEditable(i):!0)&&(r?t.isEditable(r):!0),a=(i?t.isHeader(i):!0)&&(r?t.isHeader(r):!0),s=0;s<this.getColCount();s++){var f=o.insertCell(s),d=n[s],u=t.isEditable(d),c=t.isHeader(d);this.CellManager.setEditable(f,l||u),this.CellManager.setHeader(f,a||c)}},insertCol:function(e){if(this.canInsertCol())for(var t=this.VectorManager,n=this.getRows(),o=e>0?this.getCol(e-1):null,i=e<this.getColCount()-1?this.getCol(e+1):null,r=(o?t.isEditable(o):!0)&&(i?t.isEditable(i):!0),l=(o?t.isHeader(o):!0)&&(i?t.isHeader(i):!0),a=0;a<this.getRowCount();a++){var s=this.table.rows[a].insertCell(e),f=n[a],d=t.isEditable(f),u=t.isHeader(f);this.CellManager.setEditable(s,r||d),this.CellManager.setHeader(s,l||u)}},removeRow:function(e){var t=this.getSelectionBounds();if(this.table.deleteRow(e),t){var n=t.origin,o=t.terminal;if(n&&o){var i=n[1],r=n[0],l=o[1],a=o[0],s=Math.min(r,a),f=Math.max(r,a);if(f>=e&&e>=s){var d=this.getRowCount(),u=f>=d,c={colStart:i,colEnd:l};u?(c.rowStart=r-1>=0?r-1:0,c.rowEnd=a-1>=0?a-1:0):(c.rowStart=r,c.rowEnd=a),this.select(c)}}}},removeCol:function(e){for(var t=this.getSelectionBounds(),n=this.table.rows,o=0;o<n.length;o++){var i=n[o];i.deleteCell(e)}if(t){var r=t.origin,l=t.terminal;if(r&&l){var a=r[1],s=r[0],f=l[1],d=l[0],u=Math.min(a,f),c=Math.max(a,f);if(c>=e&&e>=u){var h=this.getColCount(),g=c>=h,w={rowStart:s,rowEnd:d};g?(w.colStart=a-1>=0?a-1:0,w.colEnd=f-1>=0?f-1:0):(w.colStart=a,w.colEnd=f),this.select(w)}}}}},window.EdiTable=v}();
